run_benchmark: v0.8.0~23 /home/jkeiser/simdjson_benchmark_results/v0.7.0/15/skylake-x-gcc10.2-native.json -DCMAKE_BUILD_TYPE=Release -DCMAKE_CXX_FLAGS=-march=native
git reset --hard v0.8.0~23
HEAD is now at 22846f75 Merge pull request #1363 from simdjson/jkeiser/ondemand-benchmarks
cmake -DCMAKE_BUILD_TYPE=Release -DCMAKE_CXX_FLAGS=-march=native -DCMAKE_RULE_MESSAGES:BOOL=OFF -DCMAKE_VERBOSE_MAKEFILE:BOOL=ON ..
-- The simdjson repository appears to be standalone.
-- By default, we attempt to build everything.
-- Building a dynamic library.
-- Library output directory: /home/jkeiser/simdjson_benchmark_results/simdjson/build
-- Importing google_benchmarks (google/benchmark@8982e1e)
-- Failed to find LLVM FileCheck
-- git Version: v0.2.1-22846f75
-- Version: 0.2.1
-- Performing Test HAVE_STD_REGEX -- success
-- Performing Test HAVE_GNU_POSIX_REGEX -- failed to compile
-- Performing Test HAVE_POSIX_REGEX -- success
-- Performing Test HAVE_STEADY_CLOCK -- success
-- Importing cjson (DaveGamble/cJSON@c69134d)
-- Importing fastjson (mikeando/fastjson@485f994)
-- Importing gason (vivkin/gason@7aee524)
-- Importing jsmn (zserge/jsmn@18e9fe4)
-- Importing json (nlohmann/json@v3.9.1)
-- Importing json11 (dropbox/json11@ec4e452)
-- Importing rapidjson (Tencent/rapidjson@b32cd94)
-- Importing sajson (chadaustin/sajson@2dcfd35)
-- Importing ujson4c (esnme/ujson4c@e14f3fd)
-- Importing yyjson (ibireme/yyjson@aa33ec5)
-- Importing cxxopts (jarro2783/cxxopts@794c975)
-- cxxopts version 2.2.0
-- We have cxxopts as a dependency and we are buiding the tools (e.g., json2json).
-- Git is available and it is recent. We are enabling checkperf targets.
-- Configuring done
-- Generating done
-- Build files have been written to: /home/jkeiser/simdjson_benchmark_results/simdjson/build
make bench_ondemand
/usr/bin/cmake -S/home/jkeiser/simdjson_benchmark_results/simdjson -B/home/jkeiser/simdjson_benchmark_results/simdjson/build --check-build-system CMakeFiles/Makefile.cmake 0
make -f CMakeFiles/Makefile2 bench_ondemand
/usr/bin/cmake -S/home/jkeiser/simdjson_benchmark_results/simdjson -B/home/jkeiser/simdjson_benchmark_results/simdjson/build --check-build-system CMakeFiles/Makefile.cmake 0
/usr/bin/cmake -E cmake_progress_start /home/jkeiser/simdjson_benchmark_results/simdjson/build/CMakeFiles 11
make -f CMakeFiles/Makefile2 benchmark/CMakeFiles/bench_ondemand.dir/all
make -f _deps/google_benchmarks/src/CMakeFiles/benchmark.dir/build.make _deps/google_benchmarks/src/CMakeFiles/benchmark.dir/depend
cd /home/jkeiser/simdjson_benchmark_results/simdjson/build && /usr/bin/cmake -E cmake_depends "Unix Makefiles" /home/jkeiser/simdjson_benchmark_results/simdjson /home/jkeiser/simdjson_benchmark_results/simdjson/dependencies/.cache/google_benchmarks/src /home/jkeiser/simdjson_benchmark_results/simdjson/build /home/jkeiser/simdjson_benchmark_results/simdjson/build/_deps/google_benchmarks/src /home/jkeiser/simdjson_benchmark_results/simdjson/build/_deps/google_benchmarks/src/CMakeFiles/benchmark.dir/DependInfo.cmake --color=
make -f _deps/google_benchmarks/src/CMakeFiles/benchmark.dir/build.make _deps/google_benchmarks/src/CMakeFiles/benchmark.dir/build
make[3]: Nothing to be done for '_deps/google_benchmarks/src/CMakeFiles/benchmark.dir/build'.
[ 72%] Built target benchmark
make -f jsonexamples/generated/CMakeFiles/generated-data.dir/build.make jsonexamples/generated/CMakeFiles/generated-data.dir/depend
cd /home/jkeiser/simdjson_benchmark_results/simdjson/build && /usr/bin/cmake -E cmake_depends "Unix Makefiles" /home/jkeiser/simdjson_benchmark_results/simdjson /home/jkeiser/simdjson_benchmark_results/simdjson/jsonexamples/generated /home/jkeiser/simdjson_benchmark_results/simdjson/build /home/jkeiser/simdjson_benchmark_results/simdjson/build/jsonexamples/generated /home/jkeiser/simdjson_benchmark_results/simdjson/build/jsonexamples/generated/CMakeFiles/generated-data.dir/DependInfo.cmake --color=
make -f jsonexamples/generated/CMakeFiles/generated-data.dir/build.make jsonexamples/generated/CMakeFiles/generated-data.dir/build
make[3]: Nothing to be done for 'jsonexamples/generated/CMakeFiles/generated-data.dir/build'.
[ 72%] Built target generated-data
make -f src/CMakeFiles/simdjson.dir/build.make src/CMakeFiles/simdjson.dir/depend
cd /home/jkeiser/simdjson_benchmark_results/simdjson/build && /usr/bin/cmake -E cmake_depends "Unix Makefiles" /home/jkeiser/simdjson_benchmark_results/simdjson /home/jkeiser/simdjson_benchmark_results/simdjson/src /home/jkeiser/simdjson_benchmark_results/simdjson/build /home/jkeiser/simdjson_benchmark_results/simdjson/build/src /home/jkeiser/simdjson_benchmark_results/simdjson/build/src/CMakeFiles/simdjson.dir/DependInfo.cmake --color=
make -f src/CMakeFiles/simdjson.dir/build.make src/CMakeFiles/simdjson.dir/build
make[3]: Nothing to be done for 'src/CMakeFiles/simdjson.dir/build'.
[ 81%] Built target simdjson
make -f dependencies/CMakeFiles/yyjson.dir/build.make dependencies/CMakeFiles/yyjson.dir/depend
cd /home/jkeiser/simdjson_benchmark_results/simdjson/build && /usr/bin/cmake -E cmake_depends "Unix Makefiles" /home/jkeiser/simdjson_benchmark_results/simdjson /home/jkeiser/simdjson_benchmark_results/simdjson/dependencies /home/jkeiser/simdjson_benchmark_results/simdjson/build /home/jkeiser/simdjson_benchmark_results/simdjson/build/dependencies /home/jkeiser/simdjson_benchmark_results/simdjson/build/dependencies/CMakeFiles/yyjson.dir/DependInfo.cmake --color=
make -f dependencies/CMakeFiles/yyjson.dir/build.make dependencies/CMakeFiles/yyjson.dir/build
make[3]: Nothing to be done for 'dependencies/CMakeFiles/yyjson.dir/build'.
[ 90%] Built target yyjson
make -f benchmark/CMakeFiles/bench_ondemand.dir/build.make benchmark/CMakeFiles/bench_ondemand.dir/depend
cd /home/jkeiser/simdjson_benchmark_results/simdjson/build && /usr/bin/cmake -E cmake_depends "Unix Makefiles" /home/jkeiser/simdjson_benchmark_results/simdjson /home/jkeiser/simdjson_benchmark_results/simdjson/benchmark /home/jkeiser/simdjson_benchmark_results/simdjson/build /home/jkeiser/simdjson_benchmark_results/simdjson/build/benchmark /home/jkeiser/simdjson_benchmark_results/simdjson/build/benchmark/CMakeFiles/bench_ondemand.dir/DependInfo.cmake --color=
Scanning dependencies of target bench_ondemand
make -f benchmark/CMakeFiles/bench_ondemand.dir/build.make benchmark/CMakeFiles/bench_ondemand.dir/build
cd /home/jkeiser/simdjson_benchmark_results/simdjson/build/benchmark && /usr/bin/g++-10  -DSIMDJSON_BENCHMARK_DATA_DIR=\"/home/jkeiser/simdjson_benchmark_results/simdjson/build/jsonexamples/\" -DSIMDJSON_COMPETITION_YYJSON -DSIMDJSON_MINEFIELD_TEST_DATA_DIR=\"/home/jkeiser/simdjson_benchmark_results/simdjson/jsonchecker/minefield/\" -DSIMDJSON_TEST_DATA_DIR=\"/home/jkeiser/simdjson_benchmark_results/simdjson/jsonchecker/\" -DSIMDJSON_THREADS_ENABLED=1 -DSIMDJSON_USING_LIBRARY=1 -I/home/jkeiser/simdjson_benchmark_results/simdjson/benchmark/. -I/home/jkeiser/simdjson_benchmark_results/simdjson/benchmark/linux -I/home/jkeiser/simdjson_benchmark_results/simdjson/include -I/home/jkeiser/simdjson_benchmark_results/simdjson/dependencies/.cache/google_benchmarks/src/../include -isystem /home/jkeiser/simdjson_benchmark_results/simdjson/dependencies/.cache/yyjson/src  -march=native -O3 -DNDEBUG   -pthread -std=c++17 -o CMakeFiles/bench_ondemand.dir/bench_ondemand.cpp.o -c /home/jkeiser/simdjson_benchmark_results/simdjson/benchmark/bench_ondemand.cpp
cd /home/jkeiser/simdjson_benchmark_results/simdjson/build/benchmark && /usr/bin/cmake -E cmake_link_script CMakeFiles/bench_ondemand.dir/link.txt --verbose=1
/usr/bin/g++-10  -march=native -O3 -DNDEBUG   CMakeFiles/bench_ondemand.dir/bench_ondemand.cpp.o  -o bench_ondemand  -Wl,-rpath,/home/jkeiser/simdjson_benchmark_results/simdjson/build ../libsimdjson.so.6.0.0 ../_deps/google_benchmarks/src/libbenchmark.a ../dependencies/libyyjson.a -pthread /usr/lib/x86_64-linux-gnu/librt.so 
[100%] Built target bench_ondemand
/usr/bin/cmake -E cmake_progress_start /home/jkeiser/simdjson_benchmark_results/simdjson/build/CMakeFiles 0
benchmark/bench_ondemand --benchmark_counters_tabular=true --benchmark_out=/home/jkeiser/simdjson_benchmark_results/v0.7.0/15/skylake-x-gcc10.2-native.json --benchmark_out_format=json
2021-01-24 23:41:41
Running benchmark/bench_ondemand
Run on (4 X 3200 MHz CPU s)
CPU Caches:
  L1 Data 32 KiB (x4)
  L1 Instruction 32 KiB (x4)
  L2 Unified 1024 KiB (x4)
  L3 Unified 8448 KiB (x1)
Load Average: 1.00, 1.00, 1.00
***WARNING*** CPU scaling is enabled, the benchmark real time measurements may be noisy and will incur extra overhead.
simdjson::dom implementation:      haswell
simdjson::ondemand implementation: haswell
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Benchmark                                          Time             CPU   Iterations best_branch_miss best_bytes_per_sec best_cache_miss best_cache_ref best_cycles best_cycles_per_byte best_docs_per_sec best_frequency best_instructions best_instructions_per_byte best_instructions_per_cycle best_items_per_sec branch_miss      bytes bytes_per_second cache_miss  cache_ref     cycles cycles_per_byte docs_per_sec  frequency instructions instructions_per_byte instructions_per_cycle      items items_per_second
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
partial_tweets<simdjson_dom>                  338326 ns       338323 ns         2066           3.715k           1.97397G               3        31.456k    1021.83k              1.61807          3.12577k       3.19402G          3.07044M                    4.86203                     3.00483           312.577k    3.91426k   631.515k       1.73841G/s    2.48161   31.4728k   1028.72k         1.62898   2.95575k/s 3.04066G/s     3.07044M               4.86203                2.98471        100       295.575k/s [BEST: throughput=  1.97 GB/s doc_throughput=  3125 docs/s instructions=     3070442 cycles=     1021834 branch_miss=    3715 cache_miss=       3 cache_ref=     31456 items=       100 avg_time=    322398 ns]
partial_tweets<simdjson_ondemand>             234204 ns       234200 ns         2972           2.138k           2.89587G               0         7.101k    696.415k              1.10277           4.5856k       3.19348G          2.23694M                    3.54219                     3.21208            458.56k    2.25897k   631.515k       2.51129G/s   4.71063m   7.13758k   700.851k         1.10979   4.26986k/s 2.99253G/s     2.23694M               3.54219                3.19175        100       426.986k/s [BEST: throughput=  2.90 GB/s doc_throughput=  4585 docs/s instructions=     2236943 cycles=      696415 branch_miss=    2138 cache_miss=       0 cache_ref=      7101 items=       100 avg_time=    219603 ns]
partial_tweets<yyjson>                        874532 ns       874509 ns          799          10.365k           1079.35M             292        26.204k    1.67191M              2.64746          1.70915k       2.85754G          2.90852M                    4.60562                     1.73964           170.915k    7.71621k   631.515k       688.683M/s    616.249   25.6434k   1.77658M          2.8132    1.1435k/s 2.03151G/s     2.90895M               4.60631                1.63739        100        114.35k/s [BEST: throughput=  1.08 GB/s doc_throughput=  1709 docs/s instructions=     2908519 cycles=     1671909 branch_miss=   10365 cache_miss=     292 cache_ref=     26204 items=       100 avg_time=    856269 ns]
Creating a source file spanning 44921 KB 
large_random<simdjson_dom>                  99962199 ns     99959343 ns            7         850.481k           461.249M        6.77692M       6.89626M    317.974M              6.91267           10.0274       3.18846G          998.581M                    21.7089                     3.14044            10.0274    850.743k   45.9988M       438.857M/s   6.79344M   6.89634M   318.571M         6.92564    10.0041/s   3.187G/s     998.581M               21.7089                3.13457          1        10.0041/s [BEST: throughput=  0.46 GB/s doc_throughput=    10 docs/s instructions=   998581007 cycles=   317974437 branch_miss=  850481 cache_miss= 6776917 cache_ref=   6896260 items=         1 avg_time=  99932690 ns]
large_random<simdjson_ondemand>             67694277 ns     67692269 ns           10         882.588k           680.743M        3.46421M       3.57268M    215.443M              4.68367           14.7992       3.18837G          650.959M                    14.1517                     3.02149            14.7992    883.583k   45.9988M       648.048M/s   3.47982M   3.57274M   215.757M         4.69049    14.7727/s 3.18732G/s     650.959M               14.1517                 3.0171          1        14.7727/s [BEST: throughput=  0.68 GB/s doc_throughput=    14 docs/s instructions=   650958757 cycles=   215442979 branch_miss=  882588 cache_miss= 3464206 cache_ref=   3572684 items=         1 avg_time=  67666688 ns]
large_random<simdjson_ondemand_unordered>   70359474 ns     70358900 ns           10         861.679k            654.54M        3.40699M        3.5726M    224.106M              4.87201           14.2295       3.18892G          654.959M                    14.2386                     2.92254            14.2295    861.663k   45.9988M       623.487M/s   3.47348M   3.57266M   224.202M         4.87409    14.2128/s 3.18655G/s     654.959M               14.2386                2.92129          1        14.2128/s [BEST: throughput=  0.65 GB/s doc_throughput=    14 docs/s instructions=   654958760 cycles=   224106311 branch_miss=  861679 cache_miss= 3406989 cache_ref=   3572599 items=         1 avg_time=  70330991 ns]
large_random<yyjson>                       156449956 ns    156444668 ns            4         659.757k           294.342M        4.21057M       5.55206M    360.489M              7.83692           6.39891       2.30673G           942.15M                    20.4821                     2.61353            6.39891    662.823k   45.9988M       280.405M/s   4.21179M   5.54645M   360.853M         7.84484    6.39204/s 2.30659G/s      942.15M               20.4821                 2.6109          1        6.39204/s [BEST: throughput=  0.29 GB/s doc_throughput=     6 docs/s instructions=   942149710 cycles=   360488703 branch_miss=  659757 cache_miss= 4210571 cache_ref=   5552059 items=         1 avg_time= 156413791 ns]
Creating a source file spanning 134087 KB 
kostya<simdjson_dom>                        98632444 ns     98631625 ns            7         447.621k           1.39412G        10.1445M       10.3136M    314.033M              2.28712           10.1534       3.18852G           972.65M                    7.08386                     3.09728            10.1534    447.836k   137.305M       1.29649G/s   10.2064M   10.3141M   314.266M         2.28882    10.1387/s 3.18626G/s      972.65M               7.08386                3.09499          1        10.1387/s [BEST: throughput=  1.39 GB/s doc_throughput=    10 docs/s instructions=   972649991 cycles=   314033298 branch_miss=  447621 cache_miss=10144486 cache_ref=  10313557 items=         1 avg_time=  98601570 ns]
kostya<simdjson_ondemand>                   69693610 ns     69691300 ns           10         465.554k           1.97253G        6.30546M       6.47077M    221.963M              1.61657           14.3661       3.18874G          699.692M                     5.0959                     3.15229            14.3661    465.695k   137.305M       1.83488G/s   6.33864M   6.47086M   222.077M          1.6174     14.349/s 3.18658G/s     699.692M                5.0959                3.15068          1         14.349/s [BEST: throughput=  1.97 GB/s doc_throughput=    14 docs/s instructions=   699692079 cycles=   221963201 branch_miss=  465554 cache_miss= 6305457 cache_ref=   6470774 items=         1 avg_time=  69664186 ns]
------------------------------------------------------------------------------------
Benchmark                                          Time             CPU   Iterations
------------------------------------------------------------------------------------
kostya<yyjson>                            ERROR OCCURRED: 'warmup document reading failed'
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Benchmark                                          Time             CPU   Iterations best_branch_miss best_bytes_per_sec best_cache_miss best_cache_ref best_cycles best_cycles_per_byte best_docs_per_sec best_frequency best_instructions best_instructions_per_byte best_instructions_per_cycle best_items_per_sec branch_miss      bytes bytes_per_second cache_miss  cache_ref     cycles cycles_per_byte docs_per_sec  frequency instructions instructions_per_byte instructions_per_cycle      items items_per_second
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
distinct_user_id<simdjson_dom>                335067 ns       335060 ns         2087           3.875k           2.02636G               0        32.346k    995.214k              1.57592          3.20873k       3.19337G          3.01137M                    4.76848                     3.02585           369.004k    4.05123k   631.515k       1.75534G/s    0.51126   32.5983k   1001.75k         1.58626   2.98454k/s 2.98975G/s     3.01137M               4.76848                3.00612        115       343.222k/s [BEST: throughput=  2.03 GB/s doc_throughput=  3208 docs/s instructions=     3011367 cycles=      995214 branch_miss=    3875 cache_miss=       0 cache_ref=     32346 items=       115 avg_time=    314039 ns]
distinct_user_id<simdjson_ondemand>           220303 ns       220299 ns         3178           2.047k           3.15352G               0         3.537k     639.61k              1.01282          4.99358k       3.19395G          2.18791M                    3.46453                     3.42069           574.262k    2.16864k   631.515k       2.66976G/s   4.09062m   3.56626k   643.953k          1.0197   4.53929k/s 2.92309G/s     2.18791M               3.46453                3.39762        115       522.019k/s [BEST: throughput=  3.15 GB/s doc_throughput=  4993 docs/s instructions=     2187905 cycles=      639610 branch_miss=    2047 cache_miss=       0 cache_ref=      3537 items=       115 avg_time=    201774 ns]
distinct_user_id<yyjson>                      878466 ns       878433 ns          852          10.163k           1091.79M             237        25.307k    1.65246M              2.61665          1.72884k       2.85683G          2.87347M                    4.55012                     1.73891           198.817k    7.84783k   631.515k       685.607M/s    488.684   25.4969k   1.77148M         2.80513   1.13839k/s 2.01664G/s     2.87383M               4.55069                1.62227        115       130.915k/s [BEST: throughput=  1.09 GB/s doc_throughput=  1728 docs/s instructions=     2873471 cycles=     1652456 branch_miss=   10163 cache_miss=     237 cache_ref=     25307 items=       115 avg_time=    853472 ns]
find_tweet<simdjson_dom>                      319407 ns       319400 ns         2194            3.58k           2.12059G               0        27.284k    950.989k              1.50589          3.35795k       3.19337G          2.93033M                    4.64016                     3.08135           3.35795k    3.76976k   631.515k        1.8414G/s    0.16773   27.4624k   957.009k         1.51542   3.13087k/s 2.99627G/s     2.93033M               4.64016                3.06197          1       3.13087k/s [BEST: throughput=  2.12 GB/s doc_throughput=  3357 docs/s instructions=     2930328 cycles=      950989 branch_miss=    3580 cache_miss=       0 cache_ref=     27284 items=         1 avg_time=    300007 ns]
find_tweet<simdjson_ondemand>                 167213 ns       167210 ns         4185           1.319k           4.21823G               0         2.404k    478.295k             0.757377          6.67954k       3.19479G          1.56922M                    2.48485                     3.28087           6.67954k    1.37883k   631.515k       3.51741G/s   0.114934   2.49886k   480.344k        0.760622   5.98052k/s 2.87271G/s     1.56922M               2.48485                3.26687          1       5.98052k/s [BEST: throughput=  4.22 GB/s doc_throughput=  6679 docs/s instructions=     1569223 cycles=      478295 branch_miss=    1319 cache_miss=       0 cache_ref=      2404 items=         1 avg_time=    150488 ns]
find_tweet<yyjson>                            864119 ns       864095 ns          814           9.822k           1.11399G             336        23.788k    1.60947M              2.54859          1.76399k        2.8391G          2.82429M                    4.47224                     1.75479           1.76399k    7.56559k   631.515k       696.983M/s    469.464   24.6977k   1.73709M         2.75068   1.15728k/s  2.0103G/s     2.82471M               4.47291                1.62611          1       1.15728k/s [BEST: throughput=  1.11 GB/s doc_throughput=  1763 docs/s instructions=     2824286 cycles=     1609475 branch_miss=    9822 cache_miss=     336 cache_ref=     23788 items=         1 avg_time=    842683 ns]
