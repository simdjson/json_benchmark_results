run_benchmark: v0.8.0~23 /home/jkeiser/simdjson_benchmark_results/v0.7.0/15/skylake-gcc10.2-native.json -DCMAKE_BUILD_TYPE=Release -DCMAKE_CXX_FLAGS=-march=native
git reset --hard v0.8.0~23
HEAD is now at 22846f75 Merge pull request #1363 from simdjson/jkeiser/ondemand-benchmarks
cmake -DCMAKE_BUILD_TYPE=Release -DCMAKE_CXX_FLAGS=-march=native -DCMAKE_RULE_MESSAGES:BOOL=OFF -DCMAKE_VERBOSE_MAKEFILE:BOOL=ON ..
-- The simdjson repository appears to be standalone.
-- By default, we attempt to build everything.
-- Building a dynamic library.
-- Library output directory: /home/jkeiser/simdjson_benchmark_results/simdjson/build
-- Importing google_benchmarks (google/benchmark@8982e1e)
-- Failed to find LLVM FileCheck
-- git Version: v0.2.1-22846f75
-- Version: 0.2.1
-- Performing Test HAVE_STD_REGEX -- success
-- Performing Test HAVE_GNU_POSIX_REGEX -- failed to compile
-- Performing Test HAVE_POSIX_REGEX -- success
-- Performing Test HAVE_STEADY_CLOCK -- success
-- Importing cjson (DaveGamble/cJSON@c69134d)
-- Importing fastjson (mikeando/fastjson@485f994)
-- Importing gason (vivkin/gason@7aee524)
-- Importing jsmn (zserge/jsmn@18e9fe4)
-- Importing json (nlohmann/json@v3.9.1)
-- Importing json11 (dropbox/json11@ec4e452)
-- Importing rapidjson (Tencent/rapidjson@b32cd94)
-- Importing sajson (chadaustin/sajson@2dcfd35)
-- Importing ujson4c (esnme/ujson4c@e14f3fd)
-- Importing yyjson (ibireme/yyjson@aa33ec5)
-- Importing cxxopts (jarro2783/cxxopts@794c975)
-- cxxopts version 2.2.0
-- We have cxxopts as a dependency and we are buiding the tools (e.g., json2json).
-- Git is available and it is recent. We are enabling checkperf targets.
-- Configuring done
-- Generating done
-- Build files have been written to: /home/jkeiser/simdjson_benchmark_results/simdjson/build
make bench_ondemand
/usr/bin/cmake -S/home/jkeiser/simdjson_benchmark_results/simdjson -B/home/jkeiser/simdjson_benchmark_results/simdjson/build --check-build-system CMakeFiles/Makefile.cmake 0
make -f CMakeFiles/Makefile2 bench_ondemand
/usr/bin/cmake -S/home/jkeiser/simdjson_benchmark_results/simdjson -B/home/jkeiser/simdjson_benchmark_results/simdjson/build --check-build-system CMakeFiles/Makefile.cmake 0
/usr/bin/cmake -E cmake_progress_start /home/jkeiser/simdjson_benchmark_results/simdjson/build/CMakeFiles 11
make -f CMakeFiles/Makefile2 benchmark/CMakeFiles/bench_ondemand.dir/all
make -f _deps/google_benchmarks/src/CMakeFiles/benchmark.dir/build.make _deps/google_benchmarks/src/CMakeFiles/benchmark.dir/depend
cd /home/jkeiser/simdjson_benchmark_results/simdjson/build && /usr/bin/cmake -E cmake_depends "Unix Makefiles" /home/jkeiser/simdjson_benchmark_results/simdjson /home/jkeiser/simdjson_benchmark_results/simdjson/dependencies/.cache/google_benchmarks/src /home/jkeiser/simdjson_benchmark_results/simdjson/build /home/jkeiser/simdjson_benchmark_results/simdjson/build/_deps/google_benchmarks/src /home/jkeiser/simdjson_benchmark_results/simdjson/build/_deps/google_benchmarks/src/CMakeFiles/benchmark.dir/DependInfo.cmake --color=
make -f _deps/google_benchmarks/src/CMakeFiles/benchmark.dir/build.make _deps/google_benchmarks/src/CMakeFiles/benchmark.dir/build
make[3]: Nothing to be done for '_deps/google_benchmarks/src/CMakeFiles/benchmark.dir/build'.
[ 72%] Built target benchmark
make -f jsonexamples/generated/CMakeFiles/generated-data.dir/build.make jsonexamples/generated/CMakeFiles/generated-data.dir/depend
cd /home/jkeiser/simdjson_benchmark_results/simdjson/build && /usr/bin/cmake -E cmake_depends "Unix Makefiles" /home/jkeiser/simdjson_benchmark_results/simdjson /home/jkeiser/simdjson_benchmark_results/simdjson/jsonexamples/generated /home/jkeiser/simdjson_benchmark_results/simdjson/build /home/jkeiser/simdjson_benchmark_results/simdjson/build/jsonexamples/generated /home/jkeiser/simdjson_benchmark_results/simdjson/build/jsonexamples/generated/CMakeFiles/generated-data.dir/DependInfo.cmake --color=
make -f jsonexamples/generated/CMakeFiles/generated-data.dir/build.make jsonexamples/generated/CMakeFiles/generated-data.dir/build
make[3]: Nothing to be done for 'jsonexamples/generated/CMakeFiles/generated-data.dir/build'.
[ 72%] Built target generated-data
make -f src/CMakeFiles/simdjson.dir/build.make src/CMakeFiles/simdjson.dir/depend
cd /home/jkeiser/simdjson_benchmark_results/simdjson/build && /usr/bin/cmake -E cmake_depends "Unix Makefiles" /home/jkeiser/simdjson_benchmark_results/simdjson /home/jkeiser/simdjson_benchmark_results/simdjson/src /home/jkeiser/simdjson_benchmark_results/simdjson/build /home/jkeiser/simdjson_benchmark_results/simdjson/build/src /home/jkeiser/simdjson_benchmark_results/simdjson/build/src/CMakeFiles/simdjson.dir/DependInfo.cmake --color=
make -f src/CMakeFiles/simdjson.dir/build.make src/CMakeFiles/simdjson.dir/build
make[3]: Nothing to be done for 'src/CMakeFiles/simdjson.dir/build'.
[ 81%] Built target simdjson
make -f dependencies/CMakeFiles/yyjson.dir/build.make dependencies/CMakeFiles/yyjson.dir/depend
cd /home/jkeiser/simdjson_benchmark_results/simdjson/build && /usr/bin/cmake -E cmake_depends "Unix Makefiles" /home/jkeiser/simdjson_benchmark_results/simdjson /home/jkeiser/simdjson_benchmark_results/simdjson/dependencies /home/jkeiser/simdjson_benchmark_results/simdjson/build /home/jkeiser/simdjson_benchmark_results/simdjson/build/dependencies /home/jkeiser/simdjson_benchmark_results/simdjson/build/dependencies/CMakeFiles/yyjson.dir/DependInfo.cmake --color=
make -f dependencies/CMakeFiles/yyjson.dir/build.make dependencies/CMakeFiles/yyjson.dir/build
make[3]: Nothing to be done for 'dependencies/CMakeFiles/yyjson.dir/build'.
[ 90%] Built target yyjson
make -f benchmark/CMakeFiles/bench_ondemand.dir/build.make benchmark/CMakeFiles/bench_ondemand.dir/depend
cd /home/jkeiser/simdjson_benchmark_results/simdjson/build && /usr/bin/cmake -E cmake_depends "Unix Makefiles" /home/jkeiser/simdjson_benchmark_results/simdjson /home/jkeiser/simdjson_benchmark_results/simdjson/benchmark /home/jkeiser/simdjson_benchmark_results/simdjson/build /home/jkeiser/simdjson_benchmark_results/simdjson/build/benchmark /home/jkeiser/simdjson_benchmark_results/simdjson/build/benchmark/CMakeFiles/bench_ondemand.dir/DependInfo.cmake --color=
Scanning dependencies of target bench_ondemand
make -f benchmark/CMakeFiles/bench_ondemand.dir/build.make benchmark/CMakeFiles/bench_ondemand.dir/build
cd /home/jkeiser/simdjson_benchmark_results/simdjson/build/benchmark && /usr/bin/g++-10  -DSIMDJSON_BENCHMARK_DATA_DIR=\"/home/jkeiser/simdjson_benchmark_results/simdjson/build/jsonexamples/\" -DSIMDJSON_COMPETITION_YYJSON -DSIMDJSON_MINEFIELD_TEST_DATA_DIR=\"/home/jkeiser/simdjson_benchmark_results/simdjson/jsonchecker/minefield/\" -DSIMDJSON_TEST_DATA_DIR=\"/home/jkeiser/simdjson_benchmark_results/simdjson/jsonchecker/\" -DSIMDJSON_THREADS_ENABLED=1 -DSIMDJSON_USING_LIBRARY=1 -I/home/jkeiser/simdjson_benchmark_results/simdjson/benchmark/. -I/home/jkeiser/simdjson_benchmark_results/simdjson/benchmark/linux -I/home/jkeiser/simdjson_benchmark_results/simdjson/include -I/home/jkeiser/simdjson_benchmark_results/simdjson/dependencies/.cache/google_benchmarks/src/../include -isystem /home/jkeiser/simdjson_benchmark_results/simdjson/dependencies/.cache/yyjson/src  -march=native -O3 -DNDEBUG   -pthread -std=c++17 -o CMakeFiles/bench_ondemand.dir/bench_ondemand.cpp.o -c /home/jkeiser/simdjson_benchmark_results/simdjson/benchmark/bench_ondemand.cpp
cd /home/jkeiser/simdjson_benchmark_results/simdjson/build/benchmark && /usr/bin/cmake -E cmake_link_script CMakeFiles/bench_ondemand.dir/link.txt --verbose=1
/usr/bin/g++-10  -march=native -O3 -DNDEBUG   CMakeFiles/bench_ondemand.dir/bench_ondemand.cpp.o  -o bench_ondemand  -Wl,-rpath,/home/jkeiser/simdjson_benchmark_results/simdjson/build ../libsimdjson.so.6.0.0 ../_deps/google_benchmarks/src/libbenchmark.a ../dependencies/libyyjson.a -pthread /usr/lib/x86_64-linux-gnu/librt.so 
[100%] Built target bench_ondemand
/usr/bin/cmake -E cmake_progress_start /home/jkeiser/simdjson_benchmark_results/simdjson/build/CMakeFiles 0
benchmark/bench_ondemand --benchmark_counters_tabular=true --benchmark_out=/home/jkeiser/simdjson_benchmark_results/v0.7.0/15/skylake-gcc10.2-native.json --benchmark_out_format=json
2021-01-25 02:18:18
Running benchmark/bench_ondemand
Run on (4 X 4000 MHz CPU s)
CPU Caches:
  L1 Data 32 KiB (x4)
  L1 Instruction 32 KiB (x4)
  L2 Unified 256 KiB (x4)
  L3 Unified 8192 KiB (x1)
Load Average: 1.00, 1.00, 0.96
simdjson::dom implementation:      haswell
simdjson::ondemand implementation: haswell
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Benchmark                                          Time             CPU   Iterations best_branch_miss best_bytes_per_sec best_cache_miss best_cache_ref best_cycles best_cycles_per_byte best_docs_per_sec best_frequency best_instructions best_instructions_per_byte best_instructions_per_cycle best_items_per_sec branch_miss      bytes bytes_per_second cache_miss  cache_ref     cycles cycles_per_byte docs_per_sec  frequency instructions instructions_per_byte instructions_per_cycle      items items_per_second
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
partial_tweets<simdjson_dom>                  265905 ns       265904 ns         2633            3.74k           2.46514G               0        87.121k    945.854k              1.49775          3.90354k       3.69217G          2.91501M                    4.61591                     3.08189           390.354k    3.94783k   631.515k       2.21187G/s   0.427269   86.9453k   951.305k         1.50639   3.76075k/s 3.57763G/s     2.91501M               4.61591                3.06423        100       376.075k/s [BEST: throughput=  2.47 GB/s doc_throughput=  3903 docs/s instructions=     2915014 cycles=      945854 branch_miss=    3740 cache_miss=       0 cache_ref=     87121 items=       100 avg_time=    257790 ns]
partial_tweets<simdjson_ondemand>             179596 ns       179597 ns         3898           1.652k            3.7059G               0         54.44k     629.25k             0.996413          5.86827k       3.69261G          2.14384M                    3.39475                     3.40697           586.827k     1.7894k   631.515k        3.2748G/s   0.221652   54.6732k   633.421k         1.00302   5.56802k/s  3.5269G/s     2.14384M               3.39475                3.38454        100       556.802k/s [BEST: throughput=  3.71 GB/s doc_throughput=  5868 docs/s instructions=     2143838 cycles=      629250 branch_miss=    1652 cache_miss=       0 cache_ref=     54440 items=       100 avg_time=    171625 ns]
partial_tweets<yyjson>                        711149 ns       711142 ns          982          10.167k           1.32338G             240        67.008k    1.58092M              2.50337          2.09556k        3.3129G          2.90851M                    4.60561                     1.83976           209.556k    7.64393k   631.515k        846.89M/s    1035.31   48.7657k   1.74319M         2.76033   1.40619k/s 2.45125G/s     2.90894M               4.60629                1.66875        100       140.619k/s [BEST: throughput=  1.32 GB/s doc_throughput=  2095 docs/s instructions=     2908511 cycles=     1580917 branch_miss=   10167 cache_miss=     240 cache_ref=     67008 items=       100 avg_time=    702101 ns]
Creating a source file spanning 44921 KB 
large_random<simdjson_dom>                  92464375 ns     92463847 ns            8         864.123k           498.839M        11.0035M       15.2851M    340.155M              7.39487           10.8446       3.68885G          981.675M                    21.3413                     2.88596            10.8446    863.136k   45.9988M       474.432M/s   10.9698M   15.2827M   341.035M           7.414     10.815/s  3.6883G/s     981.675M               21.3413                2.87852          1         10.815/s [BEST: throughput=  0.50 GB/s doc_throughput=    10 docs/s instructions=   981674936 cycles=   340155084 branch_miss=  864123 cache_miss=11003463 cache_ref=  15285086 items=         1 avg_time=  92450713 ns]
large_random<simdjson_ondemand>             57975288 ns     57974805 ns           12         863.083k           795.633M        5.62847M       7.90968M    213.257M              4.63615           17.2968       3.68868G          643.053M                    13.9798                     3.01538            17.2968    863.036k   45.9988M       756.671M/s   5.64998M   7.91101M     213.8M         4.64795    17.2489/s 3.68781G/s     643.053M               13.9798                3.00773          1        17.2489/s [BEST: throughput=  0.80 GB/s doc_throughput=    17 docs/s instructions=   643052686 cycles=   213257377 branch_miss=  863083 cache_miss= 5628469 cache_ref=   7909684 items=         1 avg_time=  57961713 ns]
large_random<simdjson_ondemand_unordered>   61390047 ns     61390418 ns           11         865.774k           750.388M        5.55424M        7.9047M    226.139M               4.9162           16.3132       3.68906G          647.053M                    14.0667                      2.8613            16.3132     866.83k   45.9988M       714.572M/s    5.6339M   7.90818M   226.413M         4.92215    16.2892/s 3.68808G/s     647.053M               14.0667                2.85784          1        16.2892/s [BEST: throughput=  0.75 GB/s doc_throughput=    16 docs/s instructions=   647052689 cycles=   226139297 branch_miss=  865774 cache_miss= 5554238 cache_ref=   7904696 items=         1 avg_time=  61377164 ns]
large_random<yyjson>                       127885016 ns    127885831 ns            5         657.239k           359.892M        6.00261M       9.13961M    349.369M              7.59519           7.82395       2.73345G          942.149M                    20.4821                     2.69671            7.82395    659.745k   45.9988M       343.024M/s    5.9926M   9.11556M   349.565M         7.59944    7.81947/s 2.73341G/s     942.149M               20.4821                2.69521          1        7.81947/s [BEST: throughput=  0.36 GB/s doc_throughput=     7 docs/s instructions=   942149461 cycles=   349369448 branch_miss=  657239 cache_miss= 6002615 cache_ref=   9139612 items=         1 avg_time= 127866270 ns]
Creating a source file spanning 134087 KB 
kostya<simdjson_dom>                        85691110 ns     85691653 ns            8          443.07k            1.6053G        15.8051M       22.2702M    315.534M              2.29805           11.6915       3.68905G          938.041M                     6.8318                     2.97287            11.6915     443.24k   137.305M       1.49227G/s   15.8257M   22.1746M   316.063M          2.3019    11.6697/s 3.68837G/s     938.041M                6.8318                2.96789          1        11.6697/s [BEST: throughput=  1.61 GB/s doc_throughput=    11 docs/s instructions=   938040601 cycles=   315533546 branch_miss=  443070 cache_miss=15805132 cache_ref=  22270228 items=         1 avg_time=  85676729 ns]
kostya<simdjson_ondemand>                   59877022 ns     59877409 ns           12         461.478k           2.29725G         10.047M       14.0183M    220.493M              1.60586            16.731       3.68906G          676.093M                    4.92402                     3.06628             16.731    461.535k   137.305M       2.13562G/s   10.1036M   14.0213M   220.829M         1.60831    16.7008/s 3.68802G/s     676.093M               4.92402                3.06161          1        16.7008/s [BEST: throughput=  2.30 GB/s doc_throughput=    16 docs/s instructions=   676092748 cycles=   220492602 branch_miss=  461478 cache_miss=10047050 cache_ref=  14018303 items=         1 avg_time=  59863383 ns]
------------------------------------------------------------------------------------
Benchmark                                          Time             CPU   Iterations
------------------------------------------------------------------------------------
kostya<yyjson>                            ERROR OCCURRED: 'warmup document reading failed'
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Benchmark                                          Time             CPU   Iterations best_branch_miss best_bytes_per_sec best_cache_miss best_cache_ref best_cycles best_cycles_per_byte best_docs_per_sec best_frequency best_instructions best_instructions_per_byte best_instructions_per_cycle best_items_per_sec branch_miss      bytes bytes_per_second cache_miss  cache_ref     cycles cycles_per_byte docs_per_sec  frequency instructions instructions_per_byte instructions_per_cycle      items items_per_second
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
distinct_user_id<simdjson_dom>                262801 ns       262802 ns         2662           3.919k           2.52211G               0        88.648k    924.483k              1.46391          3.99374k       3.69214G          2.85594M                    4.52236                     3.08923            459.28k    4.08532k   631.515k       2.23797G/s    2.03231   88.5046k   930.315k         1.47315   3.80514k/s 3.53998G/s     2.85594M               4.52236                3.06986        115       437.591k/s [BEST: throughput=  2.52 GB/s doc_throughput=  3993 docs/s instructions=     2855938 cycles=      924483 branch_miss=    3919 cache_miss=       0 cache_ref=     88648 items=       115 avg_time=    252095 ns]
distinct_user_id<simdjson_ondemand>           168750 ns       168748 ns         4145           1.578k           3.99049G               0         52.87k    584.409k             0.925408          6.31892k       3.69283G          2.09759M                    3.32152                     3.58925           726.675k    1.69726k   631.515k       3.48533G/s   0.341616   52.9232k   587.779k        0.930745   5.92598k/s 3.48317G/s     2.09759M               3.32152                3.56867        115       681.488k/s [BEST: throughput=  3.99 GB/s doc_throughput=  6318 docs/s instructions=     2097588 cycles=      584409 branch_miss=    1578 cache_miss=       0 cache_ref=     52870 items=       115 avg_time=    159248 ns]
distinct_user_id<yyjson>                      704626 ns       704631 ns         1061          10.114k           1.34085G             201        65.675k    1.56626M              2.48016          2.12323k       3.32553G          2.87339M                       4.55                     1.83456           244.172k    7.78033k   631.515k       854.717M/s   1.15186k   47.4432k   1.73569M         2.74846   1.41918k/s 2.46327G/s     2.87382M               4.55068                1.65572        115       163.206k/s [BEST: throughput=  1.34 GB/s doc_throughput=  2123 docs/s instructions=     2873392 cycles=     1566256 branch_miss=   10114 cache_miss=     201 cache_ref=     65675 items=       115 avg_time=    692019 ns]
find_tweet<simdjson_dom>                      248723 ns       248725 ns         2815           3.605k           2.64332G               0         78.24k     882.12k              1.39683          4.18568k       3.69227G           2.7749M                    4.39404                     3.14572           4.18568k     3.7551k   631.515k       2.36463G/s    3.85861   78.1853k   887.751k         1.40575    4.0205k/s  3.5692G/s      2.7749M               4.39404                3.12576          1        4.0205k/s [BEST: throughput=  2.64 GB/s doc_throughput=  4185 docs/s instructions=     2774900 cycles=      882120 branch_miss=    3605 cache_miss=       0 cache_ref=     78240 items=         1 avg_time=    240555 ns]
find_tweet<simdjson_ondemand>                 120725 ns       120726 ns         5796              734           5.61836G               0        28.372k    415.105k             0.657316          8.89664k       3.69304G          1.47888M                     2.3418                     3.56267           8.89664k     790.445   631.515k       4.87172G/s   5.00345m   28.2441k   416.532k        0.659576   8.28321k/s 3.45022G/s     1.47888M                2.3418                3.55046          1       8.28321k/s [BEST: throughput=  5.62 GB/s doc_throughput=  8896 docs/s instructions=     1478881 cycles=      415105 branch_miss=     734 cache_miss=       0 cache_ref=     28372 items=         1 avg_time=    112835 ns]
find_tweet<yyjson>                            690917 ns       690923 ns         1017           9.501k           1.38409G             232        57.581k    1.51993M              2.40679          2.19169k       3.33121G          2.82427M                    4.47222                     1.85816           2.19169k    7.46669k   631.515k       871.675M/s   1.17711k   39.2588k   1.69979M         2.69161   1.44734k/s 2.46018G/s      2.8247M                4.4729                1.66179          1       1.44734k/s [BEST: throughput=  1.38 GB/s doc_throughput=  2191 docs/s instructions=     2824272 cycles=     1519926 branch_miss=    9501 cache_miss=     232 cache_ref=     57581 items=         1 avg_time=    681826 ns]
