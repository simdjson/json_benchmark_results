run_benchmark: v0.8.0~23 /home/jkeiser/simdjson_benchmark_results/v0.7.0/15/skylake-clang11-native.json -DCMAKE_BUILD_TYPE=Release -DCMAKE_CXX_FLAGS=-march=native
git reset --hard v0.8.0~23
HEAD is now at 22846f75 Merge pull request #1363 from simdjson/jkeiser/ondemand-benchmarks
cmake -DCMAKE_BUILD_TYPE=Release -DCMAKE_CXX_FLAGS=-march=native -DCMAKE_RULE_MESSAGES:BOOL=OFF -DCMAKE_VERBOSE_MAKEFILE:BOOL=ON ..
-- The simdjson repository appears to be standalone.
-- By default, we attempt to build everything.
-- Building a dynamic library.
-- Library output directory: /home/jkeiser/simdjson_benchmark_results/simdjson/build
-- Importing google_benchmarks (google/benchmark@8982e1e)
-- Failed to find LLVM FileCheck
-- git Version: v0.2.1-22846f75
-- Version: 0.2.1
-- Performing Test HAVE_THREAD_SAFETY_ATTRIBUTES -- failed to compile
-- Performing Test HAVE_STD_REGEX -- success
-- Performing Test HAVE_GNU_POSIX_REGEX -- failed to compile
-- Performing Test HAVE_POSIX_REGEX -- success
-- Performing Test HAVE_STEADY_CLOCK -- success
-- Importing cjson (DaveGamble/cJSON@c69134d)
-- Importing fastjson (mikeando/fastjson@485f994)
-- Importing gason (vivkin/gason@7aee524)
-- Importing jsmn (zserge/jsmn@18e9fe4)
-- Importing json (nlohmann/json@v3.9.1)
-- Importing json11 (dropbox/json11@ec4e452)
-- Importing rapidjson (Tencent/rapidjson@b32cd94)
-- Importing sajson (chadaustin/sajson@2dcfd35)
-- Importing ujson4c (esnme/ujson4c@e14f3fd)
-- Importing yyjson (ibireme/yyjson@aa33ec5)
-- Importing cxxopts (jarro2783/cxxopts@794c975)
-- cxxopts version 2.2.0
-- We have cxxopts as a dependency and we are buiding the tools (e.g., json2json).
-- Git is available and it is recent. We are enabling checkperf targets.
-- Configuring done
-- Generating done
-- Build files have been written to: /home/jkeiser/simdjson_benchmark_results/simdjson/build
make bench_ondemand
/usr/bin/cmake -S/home/jkeiser/simdjson_benchmark_results/simdjson -B/home/jkeiser/simdjson_benchmark_results/simdjson/build --check-build-system CMakeFiles/Makefile.cmake 0
make -f CMakeFiles/Makefile2 bench_ondemand
/usr/bin/cmake -S/home/jkeiser/simdjson_benchmark_results/simdjson -B/home/jkeiser/simdjson_benchmark_results/simdjson/build --check-build-system CMakeFiles/Makefile.cmake 0
/usr/bin/cmake -E cmake_progress_start /home/jkeiser/simdjson_benchmark_results/simdjson/build/CMakeFiles 11
make -f CMakeFiles/Makefile2 benchmark/CMakeFiles/bench_ondemand.dir/all
make -f _deps/google_benchmarks/src/CMakeFiles/benchmark.dir/build.make _deps/google_benchmarks/src/CMakeFiles/benchmark.dir/depend
cd /home/jkeiser/simdjson_benchmark_results/simdjson/build && /usr/bin/cmake -E cmake_depends "Unix Makefiles" /home/jkeiser/simdjson_benchmark_results/simdjson /home/jkeiser/simdjson_benchmark_results/simdjson/dependencies/.cache/google_benchmarks/src /home/jkeiser/simdjson_benchmark_results/simdjson/build /home/jkeiser/simdjson_benchmark_results/simdjson/build/_deps/google_benchmarks/src /home/jkeiser/simdjson_benchmark_results/simdjson/build/_deps/google_benchmarks/src/CMakeFiles/benchmark.dir/DependInfo.cmake --color=
make -f _deps/google_benchmarks/src/CMakeFiles/benchmark.dir/build.make _deps/google_benchmarks/src/CMakeFiles/benchmark.dir/build
make[3]: Nothing to be done for '_deps/google_benchmarks/src/CMakeFiles/benchmark.dir/build'.
[ 72%] Built target benchmark
make -f jsonexamples/generated/CMakeFiles/generated-data.dir/build.make jsonexamples/generated/CMakeFiles/generated-data.dir/depend
cd /home/jkeiser/simdjson_benchmark_results/simdjson/build && /usr/bin/cmake -E cmake_depends "Unix Makefiles" /home/jkeiser/simdjson_benchmark_results/simdjson /home/jkeiser/simdjson_benchmark_results/simdjson/jsonexamples/generated /home/jkeiser/simdjson_benchmark_results/simdjson/build /home/jkeiser/simdjson_benchmark_results/simdjson/build/jsonexamples/generated /home/jkeiser/simdjson_benchmark_results/simdjson/build/jsonexamples/generated/CMakeFiles/generated-data.dir/DependInfo.cmake --color=
make -f jsonexamples/generated/CMakeFiles/generated-data.dir/build.make jsonexamples/generated/CMakeFiles/generated-data.dir/build
make[3]: Nothing to be done for 'jsonexamples/generated/CMakeFiles/generated-data.dir/build'.
[ 72%] Built target generated-data
make -f src/CMakeFiles/simdjson.dir/build.make src/CMakeFiles/simdjson.dir/depend
cd /home/jkeiser/simdjson_benchmark_results/simdjson/build && /usr/bin/cmake -E cmake_depends "Unix Makefiles" /home/jkeiser/simdjson_benchmark_results/simdjson /home/jkeiser/simdjson_benchmark_results/simdjson/src /home/jkeiser/simdjson_benchmark_results/simdjson/build /home/jkeiser/simdjson_benchmark_results/simdjson/build/src /home/jkeiser/simdjson_benchmark_results/simdjson/build/src/CMakeFiles/simdjson.dir/DependInfo.cmake --color=
make -f src/CMakeFiles/simdjson.dir/build.make src/CMakeFiles/simdjson.dir/build
make[3]: Nothing to be done for 'src/CMakeFiles/simdjson.dir/build'.
[ 81%] Built target simdjson
make -f dependencies/CMakeFiles/yyjson.dir/build.make dependencies/CMakeFiles/yyjson.dir/depend
cd /home/jkeiser/simdjson_benchmark_results/simdjson/build && /usr/bin/cmake -E cmake_depends "Unix Makefiles" /home/jkeiser/simdjson_benchmark_results/simdjson /home/jkeiser/simdjson_benchmark_results/simdjson/dependencies /home/jkeiser/simdjson_benchmark_results/simdjson/build /home/jkeiser/simdjson_benchmark_results/simdjson/build/dependencies /home/jkeiser/simdjson_benchmark_results/simdjson/build/dependencies/CMakeFiles/yyjson.dir/DependInfo.cmake --color=
make -f dependencies/CMakeFiles/yyjson.dir/build.make dependencies/CMakeFiles/yyjson.dir/build
make[3]: Nothing to be done for 'dependencies/CMakeFiles/yyjson.dir/build'.
[ 90%] Built target yyjson
make -f benchmark/CMakeFiles/bench_ondemand.dir/build.make benchmark/CMakeFiles/bench_ondemand.dir/depend
cd /home/jkeiser/simdjson_benchmark_results/simdjson/build && /usr/bin/cmake -E cmake_depends "Unix Makefiles" /home/jkeiser/simdjson_benchmark_results/simdjson /home/jkeiser/simdjson_benchmark_results/simdjson/benchmark /home/jkeiser/simdjson_benchmark_results/simdjson/build /home/jkeiser/simdjson_benchmark_results/simdjson/build/benchmark /home/jkeiser/simdjson_benchmark_results/simdjson/build/benchmark/CMakeFiles/bench_ondemand.dir/DependInfo.cmake --color=
Scanning dependencies of target bench_ondemand
make -f benchmark/CMakeFiles/bench_ondemand.dir/build.make benchmark/CMakeFiles/bench_ondemand.dir/build
cd /home/jkeiser/simdjson_benchmark_results/simdjson/build/benchmark && /usr/bin/clang++-11  -DSIMDJSON_BENCHMARK_DATA_DIR=\"/home/jkeiser/simdjson_benchmark_results/simdjson/build/jsonexamples/\" -DSIMDJSON_COMPETITION_YYJSON -DSIMDJSON_MINEFIELD_TEST_DATA_DIR=\"/home/jkeiser/simdjson_benchmark_results/simdjson/jsonchecker/minefield/\" -DSIMDJSON_TEST_DATA_DIR=\"/home/jkeiser/simdjson_benchmark_results/simdjson/jsonchecker/\" -DSIMDJSON_THREADS_ENABLED=1 -DSIMDJSON_USING_LIBRARY=1 -I/home/jkeiser/simdjson_benchmark_results/simdjson/benchmark/. -I/home/jkeiser/simdjson_benchmark_results/simdjson/benchmark/linux -I/home/jkeiser/simdjson_benchmark_results/simdjson/include -I/home/jkeiser/simdjson_benchmark_results/simdjson/dependencies/.cache/google_benchmarks/src/../include -isystem /home/jkeiser/simdjson_benchmark_results/simdjson/dependencies/.cache/yyjson/src  -march=native -O3 -DNDEBUG   -pthread -std=c++17 -o CMakeFiles/bench_ondemand.dir/bench_ondemand.cpp.o -c /home/jkeiser/simdjson_benchmark_results/simdjson/benchmark/bench_ondemand.cpp
cd /home/jkeiser/simdjson_benchmark_results/simdjson/build/benchmark && /usr/bin/cmake -E cmake_link_script CMakeFiles/bench_ondemand.dir/link.txt --verbose=1
/usr/bin/clang++-11  -march=native -O3 -DNDEBUG   CMakeFiles/bench_ondemand.dir/bench_ondemand.cpp.o  -o bench_ondemand  -Wl,-rpath,/home/jkeiser/simdjson_benchmark_results/simdjson/build ../libsimdjson.so.6.0.0 ../_deps/google_benchmarks/src/libbenchmark.a ../dependencies/libyyjson.a -pthread /usr/lib/x86_64-linux-gnu/librt.so 
[100%] Built target bench_ondemand
/usr/bin/cmake -E cmake_progress_start /home/jkeiser/simdjson_benchmark_results/simdjson/build/CMakeFiles 0
benchmark/bench_ondemand --benchmark_counters_tabular=true --benchmark_out=/home/jkeiser/simdjson_benchmark_results/v0.7.0/15/skylake-clang11-native.json --benchmark_out_format=json
2021-01-25 02:00:41
Running benchmark/bench_ondemand
Run on (4 X 4000 MHz CPU s)
CPU Caches:
  L1 Data 32 KiB (x4)
  L1 Instruction 32 KiB (x4)
  L2 Unified 256 KiB (x4)
  L3 Unified 8192 KiB (x1)
Load Average: 1.01, 1.00, 0.77
simdjson::dom implementation:      haswell
simdjson::ondemand implementation: haswell
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Benchmark                                          Time             CPU   Iterations best_branch_miss best_bytes_per_sec best_cache_miss best_cache_ref best_cycles best_cycles_per_byte best_docs_per_sec best_frequency best_instructions best_instructions_per_byte best_instructions_per_cycle best_items_per_sec branch_miss      bytes bytes_per_second cache_miss  cache_ref     cycles cycles_per_byte docs_per_sec  frequency instructions instructions_per_byte instructions_per_cycle      items items_per_second
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
partial_tweets<simdjson_dom>                  281589 ns       281591 ns         2487           3.592k           2.32224G               0        93.527k    1004.17k               1.5901          3.67725k       3.69261G          2.99337M                    4.73999                     2.98093           367.725k    3.74086k   631.515k       2.08865G/s    3.48854   93.4326k   1009.11k         1.59792   3.55125k/s  3.5836G/s     2.99337M               4.73999                2.96635        100       355.125k/s [BEST: throughput=  2.32 GB/s doc_throughput=  3677 docs/s instructions=     2993372 cycles=     1004175 branch_miss=    3592 cache_miss=       0 cache_ref=     93527 items=       100 avg_time=    273462 ns]
partial_tweets<simdjson_ondemand>             167928 ns       167929 ns         4168           2.157k           3.98003G               0        58.271k    585.904k             0.927775          6.30235k       3.69257G          1.94495M                    3.07982                     3.31957           630.235k    2.29179k   631.515k       3.50234G/s  0.0424664   58.4096k   590.286k        0.934714   5.95489k/s 3.51509G/s     1.94495M               3.07982                3.29493        100       595.489k/s [BEST: throughput=  3.98 GB/s doc_throughput=  6302 docs/s instructions=     1944950 cycles=      585904 branch_miss=    2157 cache_miss=       0 cache_ref=     58271 items=       100 avg_time=    159955 ns]
partial_tweets<yyjson>                        658268 ns       658133 ns         1062           9.885k            1.4936G             206        70.349k    1.37764M              2.18149           2.3651k       3.25826G          2.91896M                    4.62215                     2.11881            236.51k    7.48009k   631.515k       915.103M/s    1039.77   51.4939k   1.54127M          2.4406   1.51945k/s 2.34189G/s     2.91939M               4.62284                1.89414        100       151.945k/s [BEST: throughput=  1.49 GB/s doc_throughput=  2365 docs/s instructions=     2918959 cycles=     1377642 branch_miss=    9885 cache_miss=     206 cache_ref=     70349 items=       100 avg_time=    649134 ns]
Creating a source file spanning 44921 KB 
large_random<simdjson_dom>                  87711069 ns     87707161 ns            8         916.718k           525.158M        10.8542M       15.4125M    323.111M              7.02434           11.4168       3.68889G          1035.69M                    22.5155                     3.20535            11.4168    917.437k   45.9988M       500.163M/s   10.8999M   15.4127M   323.367M          7.0299    11.4016/s 3.68689G/s     1035.69M               22.5155                3.20282          1        11.4016/s [BEST: throughput=  0.53 GB/s doc_throughput=    11 docs/s instructions=  1035686041 cycles=   323111245 branch_miss=  916718 cache_miss=10854215 cache_ref=  15412474 items=         1 avg_time=  87696628 ns]
large_random<simdjson_ondemand>             65936038 ns     65923435 ns           11          908.95k           698.458M        5.66694M       8.02821M    242.951M              5.28168           15.1843       3.68903G          669.142M                     14.547                     2.75423            15.1843    910.103k   45.9988M       665.436M/s   5.63428M   8.02715M   243.111M         5.28517    15.1691/s 3.68778G/s     669.142M                14.547                2.75241          1        15.1691/s [BEST: throughput=  0.70 GB/s doc_throughput=    15 docs/s instructions=   669141946 cycles=   242950743 branch_miss=  908950 cache_miss= 5666943 cache_ref=   8028207 items=         1 avg_time=  65923587 ns]
large_random<simdjson_ondemand_unordered>   66221783 ns     66220026 ns           11         905.313k           695.555M        5.55541M         8.026M    243.969M              5.30382           15.1212        3.6891G          670.142M                    14.5687                     2.74683            15.1212    906.658k   45.9988M       662.456M/s   5.62155M   8.02681M   244.176M         5.30831    15.1012/s 3.68734G/s     670.142M               14.5687                2.74451          1        15.1012/s [BEST: throughput=  0.70 GB/s doc_throughput=    15 docs/s instructions=   670141946 cycles=   243969160 branch_miss=  905313 cache_miss= 5555412 cache_ref=   8025998 items=         1 avg_time=  66208838 ns]
large_random<yyjson>                       124525496 ns    124523234 ns            6         687.981k           369.646M        5.89672M       9.09118M    337.324M              7.33333           8.03599       2.71074G          855.681M                    18.6023                     2.53667            8.03599    688.241k   45.9988M       352.286M/s     5.902M   9.08974M   337.553M          7.3383    8.03063/s 2.71076G/s     855.681M               18.6023                2.53495          1        8.03063/s [BEST: throughput=  0.37 GB/s doc_throughput=     8 docs/s instructions=   855680754 cycles=   337324384 branch_miss=  687981 cache_miss= 5896725 cache_ref=   9091180 items=         1 avg_time= 124506193 ns]
Creating a source file spanning 134087 KB 
kostya<simdjson_dom>                        92747237 ns     92746320 ns            8         1046.41k           1.48339G        15.6791M       22.3112M    341.464M               2.4869           10.8036       3.68904G          985.796M                    7.17961                     2.88697            10.8036    1048.79k   137.305M       1.37876G/s   15.7076M    22.293M   342.028M         2.49101    10.7821/s 3.68778G/s     985.796M               7.17961                2.88221          1        10.7821/s [BEST: throughput=  1.48 GB/s doc_throughput=    10 docs/s instructions=   985795974 cycles=   341463577 branch_miss= 1046407 cache_miss=15679061 cache_ref=  22311182 items=         1 avg_time=  92733305 ns]
kostya<simdjson_ondemand>                   61649764 ns     61650135 ns           11          473.78k           2.23038G        9.88654M       14.0419M    227.069M              1.65376            16.244       3.68851G          654.158M                    4.76427                     2.88088             16.244    476.033k   137.305M       2.07421G/s   9.96668M   14.0401M   227.324M         1.65562    16.2206/s 3.68733G/s     654.158M               4.76427                2.87764          1        16.2206/s [BEST: throughput=  2.23 GB/s doc_throughput=    16 docs/s instructions=   654158322 cycles=   227069077 branch_miss=  473780 cache_miss= 9886544 cache_ref=  14041921 items=         1 avg_time=  61635896 ns]
------------------------------------------------------------------------------------
Benchmark                                          Time             CPU   Iterations
------------------------------------------------------------------------------------
kostya<yyjson>                            ERROR OCCURRED: 'warmup document reading failed'
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Benchmark                                          Time             CPU   Iterations best_branch_miss best_bytes_per_sec best_cache_miss best_cache_ref best_cycles best_cycles_per_byte best_docs_per_sec best_frequency best_instructions best_instructions_per_byte best_instructions_per_cycle best_items_per_sec branch_miss      bytes bytes_per_second cache_miss  cache_ref     cycles cycles_per_byte docs_per_sec  frequency instructions instructions_per_byte instructions_per_cycle      items items_per_second
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
distinct_user_id<simdjson_dom>                276539 ns       276486 ns         2532           3.683k           2.38643G               0        94.804k    977.102k              1.54723          3.77889k       3.69236G          2.92855M                    4.63734                     2.99718           434.572k     3.8424k   631.515k       2.12721G/s    1.63073   94.8708k   983.844k         1.55791   3.61682k/s 3.55839G/s     2.92855M               4.63734                2.97664        115       415.934k/s [BEST: throughput=  2.39 GB/s doc_throughput=  3778 docs/s instructions=     2928547 cycles=      977102 branch_miss=    3683 cache_miss=       0 cache_ref=     94804 items=       115 avg_time=    266698 ns]
distinct_user_id<simdjson_ondemand>           160412 ns       160410 ns         4354           1.748k           4.20343G               0         56.77k    554.821k             0.878556          6.65611k       3.69295G          1.89445M                    2.99986                     3.41453           765.452k     1.8479k   631.515k       3.66651G/s    1.39734   56.8344k   558.284k         0.88404   6.23404k/s 3.48037G/s     1.89445M               2.99986                3.39335        115       716.914k/s [BEST: throughput=  4.20 GB/s doc_throughput=  6656 docs/s instructions=     1894454 cycles=      554821 branch_miss=    1748 cache_miss=       0 cache_ref=     56770 items=       115 avg_time=    151276 ns]
distinct_user_id<yyjson>                      649457 ns       649446 ns         1156           9.672k           1.53239G             283        70.558k    1.34832M              2.13506          2.42654k       3.27175G          2.87791M                    4.55715                     2.13444           279.052k    7.55691k   631.515k       927.344M/s   1.10272k   50.4947k   1.52594M         2.41631   1.53977k/s  2.3496G/s     2.87833M               4.55782                1.88627        115       177.074k/s [BEST: throughput=  1.53 GB/s doc_throughput=  2426 docs/s instructions=     2877906 cycles=     1348321 branch_miss=    9672 cache_miss=     283 cache_ref=     70558 items=       115 avg_time=    636924 ns]
find_tweet<simdjson_dom>                      263790 ns       263792 ns         2653           3.481k           2.48416G               0        84.042k     938.64k              1.48633          3.93365k       3.69228G          2.84337M                    4.50246                     3.02925           3.93365k    3.60159k   631.515k       2.22958G/s    5.59329   84.1214k   943.363k         1.49381   3.79087k/s 3.57616G/s     2.84337M               4.50246                3.01408          1       3.79087k/s [BEST: throughput=  2.48 GB/s doc_throughput=  3933 docs/s instructions=     2843373 cycles=      938640 branch_miss=    3481 cache_miss=       0 cache_ref=     84042 items=         1 avg_time=    255660 ns]
find_tweet<simdjson_ondemand>                 119334 ns       119332 ns         5859             1015           5.68671G               0        30.074k     410.19k             0.649533          9.00487k       3.69371G          1.38745M                    2.19703                     3.38247           9.00487k      1043.7   631.515k       4.92864G/s   2.73084m   30.0603k   411.506k        0.651617   8.37999k/s 3.44842G/s     1.38745M               2.19702                3.37164          1       8.37999k/s [BEST: throughput=  5.69 GB/s doc_throughput=  9004 docs/s instructions=     1387455 cycles=      410190 branch_miss=    1015 cache_miss=       0 cache_ref=     30074 items=         1 avg_time=    111489 ns]
find_tweet<yyjson>                            636098 ns       635946 ns         1107           9.075k           1.54848G              65        59.756k    1.30201M              2.06173          2.45201k       3.19255G           2.8173M                    4.46118                      2.1638           2.45201k    7.31238k   631.515k        947.03M/s    1.1614k    41.787k   1.48978M         2.35905   1.57246k/s 2.34262G/s     2.81772M               4.46184                1.89137          1       1.57246k/s [BEST: throughput=  1.55 GB/s doc_throughput=  2452 docs/s instructions=     2817302 cycles=     1302013 branch_miss=    9075 cache_miss=      65 cache_ref=     59756 items=         1 avg_time=    626999 ns]
