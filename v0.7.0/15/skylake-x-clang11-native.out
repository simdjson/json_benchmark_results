run_benchmark: v0.8.0~23 /home/jkeiser/simdjson_benchmark_results/v0.7.0/15/skylake-x-clang11-native.json -DCMAKE_BUILD_TYPE=Release -DCMAKE_CXX_FLAGS=-march=native
git reset --hard v0.8.0~23
HEAD is now at 22846f75 Merge pull request #1363 from simdjson/jkeiser/ondemand-benchmarks
cmake -DCMAKE_BUILD_TYPE=Release -DCMAKE_CXX_FLAGS=-march=native -DCMAKE_RULE_MESSAGES:BOOL=OFF -DCMAKE_VERBOSE_MAKEFILE:BOOL=ON ..
-- The simdjson repository appears to be standalone.
-- By default, we attempt to build everything.
-- Building a dynamic library.
-- Library output directory: /home/jkeiser/simdjson_benchmark_results/simdjson/build
-- Importing google_benchmarks (google/benchmark@8982e1e)
-- Failed to find LLVM FileCheck
-- git Version: v0.2.1-22846f75
-- Version: 0.2.1
-- Performing Test HAVE_THREAD_SAFETY_ATTRIBUTES -- failed to compile
-- Performing Test HAVE_STD_REGEX -- success
-- Performing Test HAVE_GNU_POSIX_REGEX -- failed to compile
-- Performing Test HAVE_POSIX_REGEX -- success
-- Performing Test HAVE_STEADY_CLOCK -- success
-- Importing cjson (DaveGamble/cJSON@c69134d)
-- Importing fastjson (mikeando/fastjson@485f994)
-- Importing gason (vivkin/gason@7aee524)
-- Importing jsmn (zserge/jsmn@18e9fe4)
-- Importing json (nlohmann/json@v3.9.1)
-- Importing json11 (dropbox/json11@ec4e452)
-- Importing rapidjson (Tencent/rapidjson@b32cd94)
-- Importing sajson (chadaustin/sajson@2dcfd35)
-- Importing ujson4c (esnme/ujson4c@e14f3fd)
-- Importing yyjson (ibireme/yyjson@aa33ec5)
-- Importing cxxopts (jarro2783/cxxopts@794c975)
-- cxxopts version 2.2.0
-- We have cxxopts as a dependency and we are buiding the tools (e.g., json2json).
-- Git is available and it is recent. We are enabling checkperf targets.
-- Configuring done
-- Generating done
-- Build files have been written to: /home/jkeiser/simdjson_benchmark_results/simdjson/build
make bench_ondemand
/usr/bin/cmake -S/home/jkeiser/simdjson_benchmark_results/simdjson -B/home/jkeiser/simdjson_benchmark_results/simdjson/build --check-build-system CMakeFiles/Makefile.cmake 0
make -f CMakeFiles/Makefile2 bench_ondemand
/usr/bin/cmake -S/home/jkeiser/simdjson_benchmark_results/simdjson -B/home/jkeiser/simdjson_benchmark_results/simdjson/build --check-build-system CMakeFiles/Makefile.cmake 0
/usr/bin/cmake -E cmake_progress_start /home/jkeiser/simdjson_benchmark_results/simdjson/build/CMakeFiles 11
make -f CMakeFiles/Makefile2 benchmark/CMakeFiles/bench_ondemand.dir/all
make -f _deps/google_benchmarks/src/CMakeFiles/benchmark.dir/build.make _deps/google_benchmarks/src/CMakeFiles/benchmark.dir/depend
cd /home/jkeiser/simdjson_benchmark_results/simdjson/build && /usr/bin/cmake -E cmake_depends "Unix Makefiles" /home/jkeiser/simdjson_benchmark_results/simdjson /home/jkeiser/simdjson_benchmark_results/simdjson/dependencies/.cache/google_benchmarks/src /home/jkeiser/simdjson_benchmark_results/simdjson/build /home/jkeiser/simdjson_benchmark_results/simdjson/build/_deps/google_benchmarks/src /home/jkeiser/simdjson_benchmark_results/simdjson/build/_deps/google_benchmarks/src/CMakeFiles/benchmark.dir/DependInfo.cmake --color=
make -f _deps/google_benchmarks/src/CMakeFiles/benchmark.dir/build.make _deps/google_benchmarks/src/CMakeFiles/benchmark.dir/build
make[3]: Nothing to be done for '_deps/google_benchmarks/src/CMakeFiles/benchmark.dir/build'.
[ 72%] Built target benchmark
make -f jsonexamples/generated/CMakeFiles/generated-data.dir/build.make jsonexamples/generated/CMakeFiles/generated-data.dir/depend
cd /home/jkeiser/simdjson_benchmark_results/simdjson/build && /usr/bin/cmake -E cmake_depends "Unix Makefiles" /home/jkeiser/simdjson_benchmark_results/simdjson /home/jkeiser/simdjson_benchmark_results/simdjson/jsonexamples/generated /home/jkeiser/simdjson_benchmark_results/simdjson/build /home/jkeiser/simdjson_benchmark_results/simdjson/build/jsonexamples/generated /home/jkeiser/simdjson_benchmark_results/simdjson/build/jsonexamples/generated/CMakeFiles/generated-data.dir/DependInfo.cmake --color=
make -f jsonexamples/generated/CMakeFiles/generated-data.dir/build.make jsonexamples/generated/CMakeFiles/generated-data.dir/build
make[3]: Nothing to be done for 'jsonexamples/generated/CMakeFiles/generated-data.dir/build'.
[ 72%] Built target generated-data
make -f src/CMakeFiles/simdjson.dir/build.make src/CMakeFiles/simdjson.dir/depend
cd /home/jkeiser/simdjson_benchmark_results/simdjson/build && /usr/bin/cmake -E cmake_depends "Unix Makefiles" /home/jkeiser/simdjson_benchmark_results/simdjson /home/jkeiser/simdjson_benchmark_results/simdjson/src /home/jkeiser/simdjson_benchmark_results/simdjson/build /home/jkeiser/simdjson_benchmark_results/simdjson/build/src /home/jkeiser/simdjson_benchmark_results/simdjson/build/src/CMakeFiles/simdjson.dir/DependInfo.cmake --color=
make -f src/CMakeFiles/simdjson.dir/build.make src/CMakeFiles/simdjson.dir/build
make[3]: Nothing to be done for 'src/CMakeFiles/simdjson.dir/build'.
[ 81%] Built target simdjson
make -f dependencies/CMakeFiles/yyjson.dir/build.make dependencies/CMakeFiles/yyjson.dir/depend
cd /home/jkeiser/simdjson_benchmark_results/simdjson/build && /usr/bin/cmake -E cmake_depends "Unix Makefiles" /home/jkeiser/simdjson_benchmark_results/simdjson /home/jkeiser/simdjson_benchmark_results/simdjson/dependencies /home/jkeiser/simdjson_benchmark_results/simdjson/build /home/jkeiser/simdjson_benchmark_results/simdjson/build/dependencies /home/jkeiser/simdjson_benchmark_results/simdjson/build/dependencies/CMakeFiles/yyjson.dir/DependInfo.cmake --color=
make -f dependencies/CMakeFiles/yyjson.dir/build.make dependencies/CMakeFiles/yyjson.dir/build
make[3]: Nothing to be done for 'dependencies/CMakeFiles/yyjson.dir/build'.
[ 90%] Built target yyjson
make -f benchmark/CMakeFiles/bench_ondemand.dir/build.make benchmark/CMakeFiles/bench_ondemand.dir/depend
cd /home/jkeiser/simdjson_benchmark_results/simdjson/build && /usr/bin/cmake -E cmake_depends "Unix Makefiles" /home/jkeiser/simdjson_benchmark_results/simdjson /home/jkeiser/simdjson_benchmark_results/simdjson/benchmark /home/jkeiser/simdjson_benchmark_results/simdjson/build /home/jkeiser/simdjson_benchmark_results/simdjson/build/benchmark /home/jkeiser/simdjson_benchmark_results/simdjson/build/benchmark/CMakeFiles/bench_ondemand.dir/DependInfo.cmake --color=
Scanning dependencies of target bench_ondemand
make -f benchmark/CMakeFiles/bench_ondemand.dir/build.make benchmark/CMakeFiles/bench_ondemand.dir/build
cd /home/jkeiser/simdjson_benchmark_results/simdjson/build/benchmark && /usr/bin/clang++-11  -DSIMDJSON_BENCHMARK_DATA_DIR=\"/home/jkeiser/simdjson_benchmark_results/simdjson/build/jsonexamples/\" -DSIMDJSON_COMPETITION_YYJSON -DSIMDJSON_MINEFIELD_TEST_DATA_DIR=\"/home/jkeiser/simdjson_benchmark_results/simdjson/jsonchecker/minefield/\" -DSIMDJSON_TEST_DATA_DIR=\"/home/jkeiser/simdjson_benchmark_results/simdjson/jsonchecker/\" -DSIMDJSON_THREADS_ENABLED=1 -DSIMDJSON_USING_LIBRARY=1 -I/home/jkeiser/simdjson_benchmark_results/simdjson/benchmark/. -I/home/jkeiser/simdjson_benchmark_results/simdjson/benchmark/linux -I/home/jkeiser/simdjson_benchmark_results/simdjson/include -I/home/jkeiser/simdjson_benchmark_results/simdjson/dependencies/.cache/google_benchmarks/src/../include -isystem /home/jkeiser/simdjson_benchmark_results/simdjson/dependencies/.cache/yyjson/src  -march=native -O3 -DNDEBUG   -pthread -std=c++17 -o CMakeFiles/bench_ondemand.dir/bench_ondemand.cpp.o -c /home/jkeiser/simdjson_benchmark_results/simdjson/benchmark/bench_ondemand.cpp
cd /home/jkeiser/simdjson_benchmark_results/simdjson/build/benchmark && /usr/bin/cmake -E cmake_link_script CMakeFiles/bench_ondemand.dir/link.txt --verbose=1
/usr/bin/clang++-11  -march=native -O3 -DNDEBUG   CMakeFiles/bench_ondemand.dir/bench_ondemand.cpp.o  -o bench_ondemand  -Wl,-rpath,/home/jkeiser/simdjson_benchmark_results/simdjson/build ../libsimdjson.so.6.0.0 ../_deps/google_benchmarks/src/libbenchmark.a ../dependencies/libyyjson.a -pthread /usr/lib/x86_64-linux-gnu/librt.so 
[100%] Built target bench_ondemand
/usr/bin/cmake -E cmake_progress_start /home/jkeiser/simdjson_benchmark_results/simdjson/build/CMakeFiles 0
benchmark/bench_ondemand --benchmark_counters_tabular=true --benchmark_out=/home/jkeiser/simdjson_benchmark_results/v0.7.0/15/skylake-x-clang11-native.json --benchmark_out_format=json
2021-01-24 23:21:52
Running benchmark/bench_ondemand
Run on (4 X 3200 MHz CPU s)
CPU Caches:
  L1 Data 32 KiB (x4)
  L1 Instruction 32 KiB (x4)
  L2 Unified 1024 KiB (x4)
  L3 Unified 8448 KiB (x1)
Load Average: 1.00, 0.96, 0.96
***WARNING*** CPU scaling is enabled, the benchmark real time measurements may be noisy and will incur extra overhead.
simdjson::dom implementation:      haswell
simdjson::ondemand implementation: haswell
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Benchmark                                          Time             CPU   Iterations best_branch_miss best_bytes_per_sec best_cache_miss best_cache_ref best_cycles best_cycles_per_byte best_docs_per_sec best_frequency best_instructions best_instructions_per_byte best_instructions_per_cycle best_items_per_sec branch_miss      bytes bytes_per_second cache_miss  cache_ref     cycles cycles_per_byte docs_per_sec  frequency instructions instructions_per_byte instructions_per_cycle      items items_per_second
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
partial_tweets<simdjson_dom>                  341261 ns       341252 ns         2048            3.75k            1.9578G               1         30.99k    1030.02k              1.63102          3.10016k       3.19321G          2.93219M                     4.6431                     2.84674           310.016k    3.92465k   631.515k       1.72349G/s    1.52783    31.084k   1038.13k         1.64387   2.93038k/s 3.04212G/s     2.93219M                4.6431                2.82449        100       293.038k/s [BEST: throughput=  1.96 GB/s doc_throughput=  3100 docs/s instructions=     2932189 cycles=     1030015 branch_miss=    3750 cache_miss=       1 cache_ref=     30990 items=       100 avg_time=    325381 ns]
partial_tweets<simdjson_ondemand>             198879 ns       198875 ns         3509           2.009k           3.47141G               0         7.449k    581.006k             0.920019          5.49695k       3.19376G          1.87911M                    2.97556                     3.23423           549.695k    2.24361k   631.515k       2.95735G/s  0.0142491    7.5136k   588.115k        0.931276   5.02827k/s  2.9572G/s     1.87911M               2.97556                3.19514        100       502.827k/s [BEST: throughput=  3.47 GB/s doc_throughput=  5496 docs/s instructions=     1879108 cycles=      581006 branch_miss=    2009 cache_miss=       0 cache_ref=      7449 items=       100 avg_time=    184265 ns]
partial_tweets<yyjson>                        808743 ns       808722 ns          864           9.842k           1.21278G             698        26.439k    1.46412M              2.31842          1.92043k       2.81173G          2.91887M                    4.62201                      1.9936           192.043k    7.57659k   631.515k       744.705M/s     614.59    25.796k   1.57095M         2.48759   1.23652k/s 1.94251G/s      2.9193M               4.62269                 1.8583        100       123.652k/s [BEST: throughput=  1.21 GB/s doc_throughput=  1920 docs/s instructions=     2918867 cycles=     1464116 branch_miss=    9842 cache_miss=     698 cache_ref=     26439 items=       100 avg_time=    790680 ns]
Creating a source file spanning 44921 KB 
large_random<simdjson_dom>                 101524652 ns    101520473 ns            7         902.739k           455.358M        6.77962M       6.89698M    322.139M              7.00322           9.89934       3.18897G          1020.45M                    22.1843                     3.16773            9.89934    902.549k   45.9988M       432.108M/s   6.79335M   6.89675M   323.638M          7.0358    9.85023/s 3.18791G/s     1020.45M               22.1843                3.15307          1        9.85023/s [BEST: throughput=  0.46 GB/s doc_throughput=     9 docs/s instructions=  1020451781 cycles=   322139319 branch_miss=  902739 cache_miss= 6779621 cache_ref=   6896982 items=         1 avg_time= 101496395 ns]
large_random<simdjson_ondemand>             72451955 ns     72450029 ns           10         906.865k           635.506M        3.50448M       3.57283M    230.839M              5.01837           13.8157        3.1892G          653.908M                    14.2158                     2.83275            13.8157    907.933k   45.9988M       605.491M/s   3.49505M   3.57284M   230.955M         5.02089    13.8026/s 3.18778G/s     653.908M               14.2158                2.83132          1        13.8026/s [BEST: throughput=  0.64 GB/s doc_throughput=    13 docs/s instructions=   653907678 cycles=   230838683 branch_miss=  906865 cache_miss= 3504477 cache_ref=   3572832 items=         1 avg_time=  72425068 ns]
large_random<simdjson_ondemand_unordered>   73005907 ns     73002929 ns           10         905.958k           632.595M        3.40749M        3.5723M    231.892M              5.04126           13.7524       3.18908G          654.908M                    14.2375                     2.82419            13.7524    907.281k   45.9988M       600.905M/s   3.47951M   3.57307M   232.213M         5.04824    13.6981/s 3.18087G/s     654.908M               14.2375                2.82029          1        13.6981/s [BEST: throughput=  0.63 GB/s doc_throughput=    13 docs/s instructions=   654907677 cycles=   231891849 branch_miss=  905958 cache_miss= 3407492 cache_ref=   3572302 items=         1 avg_time=  72978425 ns]
large_random<yyjson>                       153422268 ns    153415859 ns            5         709.874k           300.055M        4.20876M        5.3656M    351.111M              7.63305           6.52311       2.29033G          855.681M                    18.6023                     2.43707            6.52311    707.426k   45.9988M       285.941M/s    4.2104M   5.38762M   351.458M          7.6406    6.51823/s 2.29088G/s     855.681M               18.6023                2.43466          1        6.51823/s [BEST: throughput=  0.30 GB/s doc_throughput=     6 docs/s instructions=   855681063 cycles=   351110862 branch_miss=  709874 cache_miss= 4208764 cache_ref=   5365598 items=         1 avg_time= 153388394 ns]
Creating a source file spanning 134087 KB 
kostya<simdjson_dom>                       108761859 ns    108751134 ns            6         1019.42k           1.26462G        10.1545M       10.3185M    346.225M              2.52157           9.21027       3.18882G          971.996M                     7.0791                     2.80741            9.21027    1020.11k   137.305M       1.17585G/s   10.2054M   10.3183M   346.628M         2.52451    9.19531/s 3.18735G/s     971.996M                7.0791                2.80414          1        9.19531/s [BEST: throughput=  1.26 GB/s doc_throughput=     9 docs/s instructions=   971995678 cycles=   346224621 branch_miss= 1019423 cache_miss=10154528 cache_ref=  10318469 items=         1 avg_time= 108731549 ns]
kostya<simdjson_ondemand>                   68171291 ns     68170614 ns           10          451.21k           2.01761G         6.3573M       6.47014M    217.018M              1.58056           14.6943       3.18895G          641.407M                     4.6714                     2.95554            14.6943    451.383k   137.305M       1.87581G/s   6.36699M   6.47015M   217.288M         1.58252    14.6691/s 3.18741G/s     641.407M                4.6714                2.95187          1        14.6691/s [BEST: throughput=  2.02 GB/s doc_throughput=    14 docs/s instructions=   641406588 cycles=   217018497 branch_miss=  451210 cache_miss= 6357301 cache_ref=   6470144 items=         1 avg_time=  68142958 ns]
------------------------------------------------------------------------------------
Benchmark                                          Time             CPU   Iterations
------------------------------------------------------------------------------------
kostya<yyjson>                            ERROR OCCURRED: 'warmup document reading failed'
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Benchmark                                          Time             CPU   Iterations best_branch_miss best_bytes_per_sec best_cache_miss best_cache_ref best_cycles best_cycles_per_byte best_docs_per_sec best_frequency best_instructions best_instructions_per_byte best_instructions_per_cycle best_items_per_sec branch_miss      bytes bytes_per_second cache_miss  cache_ref     cycles cycles_per_byte docs_per_sec  frequency instructions instructions_per_byte instructions_per_cycle      items items_per_second
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
distinct_user_id<simdjson_dom>                334552 ns       334546 ns         2092           3.787k           2.02823G               0        32.463k    994.451k              1.57471           3.2117k       3.19387G          2.86746M                    4.54061                     2.88346           369.345k    3.97817k   631.515k       1.75804G/s   0.210803   32.4903k   1002.57k         1.58756   2.98913k/s 2.99681G/s     2.86746M               4.54061                2.86011        115        343.75k/s [BEST: throughput=  2.03 GB/s doc_throughput=  3211 docs/s instructions=     2867464 cycles=      994451 branch_miss=    3787 cache_miss=       0 cache_ref=     32463 items=       115 avg_time=    314191 ns]
distinct_user_id<simdjson_ondemand>           191270 ns       191267 ns         3657           1.793k           3.67545G               0         4.692k    548.774k              0.86898          5.82004k       3.19389G          1.82797M                    2.89458                       3.331           669.305k    1.91543k   631.515k       3.07499G/s   0.626743   4.69041k   552.806k        0.875364    5.2283k/s 2.89023G/s     1.82797M               2.89458                3.30671        115       601.254k/s [BEST: throughput=  3.68 GB/s doc_throughput=  5820 docs/s instructions=     1827968 cycles=      548774 branch_miss=    1793 cache_miss=       0 cache_ref=      4692 items=       115 avg_time=    173217 ns]
distinct_user_id<yyjson>                      809644 ns       809637 ns          928             9.9k           1.22788G             222        25.316k    1.44172M              2.28296          1.94434k       2.80319G          2.87799M                    4.55727                     1.99621           223.599k    7.70538k   631.515k       743.864M/s     487.38   25.5496k   1.55741M         2.46615   1.23512k/s 1.92359G/s     2.87834M               4.55784                1.84816        115       142.039k/s [BEST: throughput=  1.23 GB/s doc_throughput=  1944 docs/s instructions=     2877985 cycles=     1441721 branch_miss=    9900 cache_miss=     222 cache_ref=     25316 items=       115 avg_time=    785414 ns]
find_tweet<simdjson_dom>                      319107 ns       319104 ns         2194           3.493k            2.1196G              13        28.091k    951.524k              1.50673          3.35638k       3.19368G          2.78229M                    4.40574                     2.92404           3.35638k    3.65903k   631.515k       1.84311G/s    12.9348    28.288k   957.406k         1.51605   3.13377k/s 3.00029G/s     2.78229M               4.40574                2.90607          1       3.13377k/s [BEST: throughput=  2.12 GB/s doc_throughput=  3356 docs/s instructions=     2782290 cycles=      951524 branch_miss=    3493 cache_miss=      13 cache_ref=     28091 items=         1 avg_time=    300050 ns]
find_tweet<simdjson_ondemand>                 145051 ns       145050 ns         4816              959           4.94263G               0         1.982k     408.12k             0.646255          7.82662k        3.1942G          1.32097M                    2.09175                     3.23673           7.82662k     1002.34   631.515k       4.05476G/s    1.33638   2.04677k    410.05k        0.649311   6.89417k/s 2.82695G/s     1.32097M               2.09175                 3.2215          1       6.89417k/s [BEST: throughput=  4.94 GB/s doc_throughput=  7826 docs/s instructions=     1320974 cycles=      408120 branch_miss=     959 cache_miss=       0 cache_ref=      1982 items=         1 avg_time=    128463 ns]
find_tweet<yyjson>                            796524 ns       796501 ns          883           9.466k           1.23584G             226        23.974k    1.39809M              2.21387          1.95694k       2.73599G          2.81731M                    4.46119                     2.01511           1.95694k    7.43366k   631.515k       756.132M/s    468.894   24.8198k   1.52534M         2.41536   1.25549k/s 1.91505G/s     2.81773M               4.46186                1.84728          1       1.25549k/s [BEST: throughput=  1.24 GB/s doc_throughput=  1956 docs/s instructions=     2817306 cycles=     1398093 branch_miss=    9466 cache_miss=     226 cache_ref=     23974 items=         1 avg_time=    775280 ns]
