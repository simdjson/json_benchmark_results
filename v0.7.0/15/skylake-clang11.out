run_benchmark: v0.8.0~23 /home/jkeiser/simdjson_benchmark_results/v0.7.0/15/skylake-clang11.json -DCMAKE_BUILD_TYPE=Release
git reset --hard v0.8.0~23
HEAD is now at 22846f75 Merge pull request #1363 from simdjson/jkeiser/ondemand-benchmarks
cmake -DCMAKE_BUILD_TYPE=Release -DCMAKE_RULE_MESSAGES:BOOL=OFF -DCMAKE_VERBOSE_MAKEFILE:BOOL=ON ..
-- The simdjson repository appears to be standalone.
-- By default, we attempt to build everything.
-- Building a dynamic library.
-- Library output directory: /home/jkeiser/simdjson_benchmark_results/simdjson/build
-- Importing google_benchmarks (google/benchmark@8982e1e)
-- Failed to find LLVM FileCheck
-- git Version: v0.2.1-22846f75
-- Version: 0.2.1
-- Performing Test HAVE_THREAD_SAFETY_ATTRIBUTES -- failed to compile
-- Performing Test HAVE_STD_REGEX -- success
-- Performing Test HAVE_GNU_POSIX_REGEX -- failed to compile
-- Performing Test HAVE_POSIX_REGEX -- success
-- Performing Test HAVE_STEADY_CLOCK -- success
-- Importing cjson (DaveGamble/cJSON@c69134d)
-- Importing fastjson (mikeando/fastjson@485f994)
-- Importing gason (vivkin/gason@7aee524)
-- Importing jsmn (zserge/jsmn@18e9fe4)
-- Importing json (nlohmann/json@v3.9.1)
-- Importing json11 (dropbox/json11@ec4e452)
-- Importing rapidjson (Tencent/rapidjson@b32cd94)
-- Importing sajson (chadaustin/sajson@2dcfd35)
-- Importing ujson4c (esnme/ujson4c@e14f3fd)
-- Importing yyjson (ibireme/yyjson@aa33ec5)
-- Importing cxxopts (jarro2783/cxxopts@794c975)
-- cxxopts version 2.2.0
-- We have cxxopts as a dependency and we are buiding the tools (e.g., json2json).
-- Git is available and it is recent. We are enabling checkperf targets.
-- Configuring done
-- Generating done
-- Build files have been written to: /home/jkeiser/simdjson_benchmark_results/simdjson/build
make bench_ondemand
/usr/bin/cmake -S/home/jkeiser/simdjson_benchmark_results/simdjson -B/home/jkeiser/simdjson_benchmark_results/simdjson/build --check-build-system CMakeFiles/Makefile.cmake 0
make -f CMakeFiles/Makefile2 bench_ondemand
/usr/bin/cmake -S/home/jkeiser/simdjson_benchmark_results/simdjson -B/home/jkeiser/simdjson_benchmark_results/simdjson/build --check-build-system CMakeFiles/Makefile.cmake 0
/usr/bin/cmake -E cmake_progress_start /home/jkeiser/simdjson_benchmark_results/simdjson/build/CMakeFiles 11
make -f CMakeFiles/Makefile2 benchmark/CMakeFiles/bench_ondemand.dir/all
make -f _deps/google_benchmarks/src/CMakeFiles/benchmark.dir/build.make _deps/google_benchmarks/src/CMakeFiles/benchmark.dir/depend
cd /home/jkeiser/simdjson_benchmark_results/simdjson/build && /usr/bin/cmake -E cmake_depends "Unix Makefiles" /home/jkeiser/simdjson_benchmark_results/simdjson /home/jkeiser/simdjson_benchmark_results/simdjson/dependencies/.cache/google_benchmarks/src /home/jkeiser/simdjson_benchmark_results/simdjson/build /home/jkeiser/simdjson_benchmark_results/simdjson/build/_deps/google_benchmarks/src /home/jkeiser/simdjson_benchmark_results/simdjson/build/_deps/google_benchmarks/src/CMakeFiles/benchmark.dir/DependInfo.cmake --color=
make -f _deps/google_benchmarks/src/CMakeFiles/benchmark.dir/build.make _deps/google_benchmarks/src/CMakeFiles/benchmark.dir/build
make[3]: Nothing to be done for '_deps/google_benchmarks/src/CMakeFiles/benchmark.dir/build'.
[ 72%] Built target benchmark
make -f jsonexamples/generated/CMakeFiles/generated-data.dir/build.make jsonexamples/generated/CMakeFiles/generated-data.dir/depend
cd /home/jkeiser/simdjson_benchmark_results/simdjson/build && /usr/bin/cmake -E cmake_depends "Unix Makefiles" /home/jkeiser/simdjson_benchmark_results/simdjson /home/jkeiser/simdjson_benchmark_results/simdjson/jsonexamples/generated /home/jkeiser/simdjson_benchmark_results/simdjson/build /home/jkeiser/simdjson_benchmark_results/simdjson/build/jsonexamples/generated /home/jkeiser/simdjson_benchmark_results/simdjson/build/jsonexamples/generated/CMakeFiles/generated-data.dir/DependInfo.cmake --color=
make -f jsonexamples/generated/CMakeFiles/generated-data.dir/build.make jsonexamples/generated/CMakeFiles/generated-data.dir/build
make[3]: Nothing to be done for 'jsonexamples/generated/CMakeFiles/generated-data.dir/build'.
[ 72%] Built target generated-data
make -f src/CMakeFiles/simdjson.dir/build.make src/CMakeFiles/simdjson.dir/depend
cd /home/jkeiser/simdjson_benchmark_results/simdjson/build && /usr/bin/cmake -E cmake_depends "Unix Makefiles" /home/jkeiser/simdjson_benchmark_results/simdjson /home/jkeiser/simdjson_benchmark_results/simdjson/src /home/jkeiser/simdjson_benchmark_results/simdjson/build /home/jkeiser/simdjson_benchmark_results/simdjson/build/src /home/jkeiser/simdjson_benchmark_results/simdjson/build/src/CMakeFiles/simdjson.dir/DependInfo.cmake --color=
make -f src/CMakeFiles/simdjson.dir/build.make src/CMakeFiles/simdjson.dir/build
make[3]: Nothing to be done for 'src/CMakeFiles/simdjson.dir/build'.
[ 81%] Built target simdjson
make -f dependencies/CMakeFiles/yyjson.dir/build.make dependencies/CMakeFiles/yyjson.dir/depend
cd /home/jkeiser/simdjson_benchmark_results/simdjson/build && /usr/bin/cmake -E cmake_depends "Unix Makefiles" /home/jkeiser/simdjson_benchmark_results/simdjson /home/jkeiser/simdjson_benchmark_results/simdjson/dependencies /home/jkeiser/simdjson_benchmark_results/simdjson/build /home/jkeiser/simdjson_benchmark_results/simdjson/build/dependencies /home/jkeiser/simdjson_benchmark_results/simdjson/build/dependencies/CMakeFiles/yyjson.dir/DependInfo.cmake --color=
make -f dependencies/CMakeFiles/yyjson.dir/build.make dependencies/CMakeFiles/yyjson.dir/build
make[3]: Nothing to be done for 'dependencies/CMakeFiles/yyjson.dir/build'.
[ 90%] Built target yyjson
make -f benchmark/CMakeFiles/bench_ondemand.dir/build.make benchmark/CMakeFiles/bench_ondemand.dir/depend
cd /home/jkeiser/simdjson_benchmark_results/simdjson/build && /usr/bin/cmake -E cmake_depends "Unix Makefiles" /home/jkeiser/simdjson_benchmark_results/simdjson /home/jkeiser/simdjson_benchmark_results/simdjson/benchmark /home/jkeiser/simdjson_benchmark_results/simdjson/build /home/jkeiser/simdjson_benchmark_results/simdjson/build/benchmark /home/jkeiser/simdjson_benchmark_results/simdjson/build/benchmark/CMakeFiles/bench_ondemand.dir/DependInfo.cmake --color=
Scanning dependencies of target bench_ondemand
make -f benchmark/CMakeFiles/bench_ondemand.dir/build.make benchmark/CMakeFiles/bench_ondemand.dir/build
cd /home/jkeiser/simdjson_benchmark_results/simdjson/build/benchmark && /usr/bin/clang++-11  -DSIMDJSON_BENCHMARK_DATA_DIR=\"/home/jkeiser/simdjson_benchmark_results/simdjson/build/jsonexamples/\" -DSIMDJSON_COMPETITION_YYJSON -DSIMDJSON_MINEFIELD_TEST_DATA_DIR=\"/home/jkeiser/simdjson_benchmark_results/simdjson/jsonchecker/minefield/\" -DSIMDJSON_TEST_DATA_DIR=\"/home/jkeiser/simdjson_benchmark_results/simdjson/jsonchecker/\" -DSIMDJSON_THREADS_ENABLED=1 -DSIMDJSON_USING_LIBRARY=1 -I/home/jkeiser/simdjson_benchmark_results/simdjson/benchmark/. -I/home/jkeiser/simdjson_benchmark_results/simdjson/benchmark/linux -I/home/jkeiser/simdjson_benchmark_results/simdjson/include -I/home/jkeiser/simdjson_benchmark_results/simdjson/dependencies/.cache/google_benchmarks/src/../include -isystem /home/jkeiser/simdjson_benchmark_results/simdjson/dependencies/.cache/yyjson/src  -O3 -DNDEBUG   -pthread -std=c++17 -o CMakeFiles/bench_ondemand.dir/bench_ondemand.cpp.o -c /home/jkeiser/simdjson_benchmark_results/simdjson/benchmark/bench_ondemand.cpp
cd /home/jkeiser/simdjson_benchmark_results/simdjson/build/benchmark && /usr/bin/cmake -E cmake_link_script CMakeFiles/bench_ondemand.dir/link.txt --verbose=1
/usr/bin/clang++-11  -O3 -DNDEBUG   CMakeFiles/bench_ondemand.dir/bench_ondemand.cpp.o  -o bench_ondemand  -Wl,-rpath,/home/jkeiser/simdjson_benchmark_results/simdjson/build ../libsimdjson.so.6.0.0 ../_deps/google_benchmarks/src/libbenchmark.a ../dependencies/libyyjson.a -pthread /usr/lib/x86_64-linux-gnu/librt.so 
[100%] Built target bench_ondemand
/usr/bin/cmake -E cmake_progress_start /home/jkeiser/simdjson_benchmark_results/simdjson/build/CMakeFiles 0
benchmark/bench_ondemand --benchmark_counters_tabular=true --benchmark_out=/home/jkeiser/simdjson_benchmark_results/v0.7.0/15/skylake-clang11.json --benchmark_out_format=json
2021-01-25 01:52:08
Running benchmark/bench_ondemand
Run on (4 X 4000 MHz CPU s)
CPU Caches:
  L1 Data 32 KiB (x4)
  L1 Instruction 32 KiB (x4)
  L2 Unified 256 KiB (x4)
  L3 Unified 8192 KiB (x1)
Load Average: 1.00, 0.82, 0.55
simdjson::dom implementation:      haswell
simdjson::ondemand implementation: fallback
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Benchmark                                          Time             CPU   Iterations best_branch_miss best_bytes_per_sec best_cache_miss best_cache_ref best_cycles best_cycles_per_byte best_docs_per_sec best_frequency best_instructions best_instructions_per_byte best_instructions_per_cycle best_items_per_sec branch_miss      bytes bytes_per_second cache_miss  cache_ref     cycles cycles_per_byte docs_per_sec  frequency instructions instructions_per_byte instructions_per_cycle      items items_per_second
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
partial_tweets<simdjson_dom>                  286131 ns       286133 ns         2446           3.411k           2.28518G               0        93.279k    1020.38k              1.61576          3.61857k        3.6923G           2.9828M                    4.72325                     2.92324           361.857k    3.51546k   631.515k       2.05549G/s     7.2269   93.2375k   1025.32k         1.62358   3.49488k/s 3.58335G/s      2.9828M               4.72325                2.90915        100       349.488k/s [BEST: throughput=  2.29 GB/s doc_throughput=  3618 docs/s instructions=     2982801 cycles=     1020375 branch_miss=    3411 cache_miss=       0 cache_ref=     93279 items=       100 avg_time=    277826 ns]
partial_tweets<simdjson_ondemand>            1262664 ns      1262662 ns          554          33.148k             507.4M               0        59.787k    4.59459M               7.2755           803.464       3.69158G          10.9855M                    17.3955                     2.39098           80.3464k    34.0258k   631.515k       476.976M/s   0.207581   59.9046k   4.62831M         7.32889    791.978/s 3.66551G/s     10.9855M               17.3955                2.37356        100       79.1978k/s [BEST: throughput=  0.51 GB/s doc_throughput=   803 docs/s instructions=    10985547 cycles=     4594586 branch_miss=   33148 cache_miss=       0 cache_ref=     59787 items=       100 avg_time=   1254382 ns]
partial_tweets<yyjson>                        650118 ns       650123 ns         1073          10.048k           1.52686G             381        71.011k    1.35168M              2.14038          2.41777k       3.26806G          2.91926M                    4.62263                     2.15972           241.777k    7.46414k   631.515k       926.378M/s    1069.61   51.7338k   1.51298M         2.39579   1.53817k/s 2.32721G/s     2.91969M               4.62331                1.92977        100       153.817k/s [BEST: throughput=  1.53 GB/s doc_throughput=  2417 docs/s instructions=     2919258 cycles=     1351681 branch_miss=   10048 cache_miss=     381 cache_ref=     71011 items=       100 avg_time=    640998 ns]
Creating a source file spanning 44921 KB 
large_random<simdjson_dom>                  89818746 ns     89818009 ns            8         956.017k            513.17M        11.0475M       15.6023M    330.662M              7.18849           11.1562       3.68892G          1038.74M                    22.5819                     3.14139            11.1562    958.232k   45.9988M       488.408M/s   11.1263M   15.6047M   331.244M         7.20115    11.1336/s 3.68795G/s     1038.74M               22.5819                3.13587          1        11.1336/s [BEST: throughput=  0.51 GB/s doc_throughput=    11 docs/s instructions=  1038738105 cycles=   330661902 branch_miss=  956017 cache_miss=11047462 cache_ref=  15602251 items=         1 avg_time=  89804407 ns]
large_random<simdjson_ondemand>            107115160 ns    107115802 ns            6         1.29459M           430.212M        5.66444M       8.12339M     394.41M              8.57436           9.35269       3.68879G          1.21898G                    26.5002                     3.09063            9.35269    1.29402M   45.9988M       409.537M/s    5.7336M   8.12406M   395.085M         8.58903    9.33569/s 3.68839G/s     1.21898G               26.5002                3.08535          1        9.33569/s [BEST: throughput=  0.43 GB/s doc_throughput=     9 docs/s instructions=  1218976299 cycles=   394410220 branch_miss= 1294589 cache_miss= 5664437 cache_ref=   8123386 items=         1 avg_time= 107100925 ns]
large_random<simdjson_ondemand_unordered>  107443876 ns    107441727 ns            7         1.30227M           431.499M        5.67834M       8.12132M    393.288M              8.54997           9.38066        3.6893G          1.22398G                    26.6089                     3.11216            9.38066    1.28072M   45.9988M       408.294M/s   5.73331M   8.12187M   396.295M         8.61534    9.30737/s 3.68847G/s     1.22398G               26.6089                3.08855          1        9.30737/s [BEST: throughput=  0.43 GB/s doc_throughput=     9 docs/s instructions=  1223976296 cycles=   393288016 branch_miss= 1302269 cache_miss= 5678337 cache_ref=   8121324 items=         1 avg_time= 107430412 ns]
large_random<yyjson>                       117152907 ns    117151468 ns            6         680.287k           392.826M        5.96797M       9.24697M    309.867M              6.73641           8.53991       2.64623G          855.681M                    18.6023                     2.76145            8.53991    680.082k   45.9988M       374.454M/s   5.96283M   9.24223M   309.918M         6.73752    8.53596/s 2.64544G/s     855.681M               18.6023                2.76099          1        8.53596/s [BEST: throughput=  0.39 GB/s doc_throughput=     8 docs/s instructions=   855680751 cycles=   309866637 branch_miss=  680287 cache_miss= 5967965 cache_ref=   9246972 items=         1 avg_time= 117134326 ns]
Creating a source file spanning 134087 KB 
kostya<simdjson_dom>                       100686670 ns    100683938 ns            7         1017.63k           1.36494G        16.1158M       22.8533M    371.092M              2.70269           9.94094         3.689G          984.675M                    7.17144                     2.65345            9.94094    1017.69k   137.305M       1.27007G/s    16.138M   22.7844M    371.33M         2.70442    9.93207/s 3.68808G/s     984.675M               7.17144                2.65175          1        9.93207/s [BEST: throughput=  1.36 GB/s doc_throughput=     9 docs/s instructions=   984674892 cycles=   371092151 branch_miss= 1017629 cache_miss=16115843 cache_ref=  22853298 items=         1 avg_time= 100672016 ns]
kostya<simdjson_ondemand>                  197972428 ns    197971017 ns            4         685.609k           696.189M        10.3312M       14.3504M      727.6M              5.29915           5.07038       3.68921G          2.21249G                    16.1137                     3.04081            5.07038    754.694k   137.305M       661.431M/s   10.4009M   14.3809M   730.344M         5.31913    5.05124/s 3.68914G/s     2.21249G               16.1137                3.02939          1        5.05124/s [BEST: throughput=  0.70 GB/s doc_throughput=     5 docs/s instructions=  2212492361 cycles=   727599795 branch_miss=  685609 cache_miss=10331154 cache_ref=  14350435 items=         1 avg_time= 197957256 ns]
------------------------------------------------------------------------------------
Benchmark                                          Time             CPU   Iterations
------------------------------------------------------------------------------------
kostya<yyjson>                            ERROR OCCURRED: 'warmup document reading failed'
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Benchmark                                          Time             CPU   Iterations best_branch_miss best_bytes_per_sec best_cache_miss best_cache_ref best_cycles best_cycles_per_byte best_docs_per_sec best_frequency best_instructions best_instructions_per_byte best_instructions_per_cycle best_items_per_sec branch_miss      bytes bytes_per_second cache_miss  cache_ref     cycles cycles_per_byte docs_per_sec  frequency instructions instructions_per_byte instructions_per_cycle      items items_per_second
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
distinct_user_id<simdjson_dom>                276657 ns       276655 ns         2524           3.543k           2.38728G               0        94.045k    976.724k              1.54664          3.78025k       3.69226G          2.91782M                    4.62035                     2.98736           434.728k    3.71692k   631.515k       2.12591G/s    6.24485   93.9673k   982.286k         1.55544   3.61461k/s 3.55059G/s     2.91782M               4.62035                2.97044        115       415.681k/s [BEST: throughput=  2.39 GB/s doc_throughput=  3780 docs/s instructions=     2917823 cycles=      976724 branch_miss=    3543 cache_miss=       0 cache_ref=     94045 items=       115 avg_time=    266180 ns]
distinct_user_id<simdjson_ondemand>          1217245 ns      1217236 ns          575          32.512k           526.942M               0         57.47k    4.42426M              7.00578            834.41       3.69164G          10.6053M                    16.7934                     2.39708           95.9571k    33.3772k   631.515k       494.776M/s   0.116522   57.4837k   4.45575M         7.05565    821.533/s 3.66055G/s     10.6053M               16.7934                2.38014        115       94.4763k/s [BEST: throughput=  0.53 GB/s doc_throughput=   834 docs/s instructions=    10605297 cycles=     4424256 branch_miss=   32512 cache_miss=       0 cache_ref=     57470 items=       115 avg_time=   1207603 ns]
distinct_user_id<yyjson>                      641967 ns       641941 ns         1172          10.056k           1.55687G             306        68.639k    1.33018M              2.10633          2.46529k       3.27928G          2.87812M                    4.55749                     2.16372           283.509k    7.60539k   631.515k       938.185M/s   1.19123k   50.6585k   1.50046M         2.37596   1.55777k/s 2.33737G/s     2.87848M               4.55805                 1.9184        115       179.144k/s [BEST: throughput=  1.56 GB/s doc_throughput=  2465 docs/s instructions=     2878122 cycles=     1330176 branch_miss=   10056 cache_miss=     306 cache_ref=     68639 items=       115 avg_time=    629620 ns]
find_tweet<simdjson_dom>                      262362 ns       262364 ns         2662           3.104k           2.50289G               0        83.392k    931.673k               1.4753          3.96332k       3.69251G           2.8325M                    4.48525                     3.04023           3.96332k    3.27908k   631.515k       2.24171G/s    1.69309    83.357k   937.693k         1.48483    3.8115k/s 3.57401G/s      2.8325M               4.48525                3.02071          1        3.8115k/s [BEST: throughput=  2.50 GB/s doc_throughput=  3963 docs/s instructions=     2832503 cycles=      931673 branch_miss=    3104 cache_miss=       0 cache_ref=     83392 items=         1 avg_time=    254068 ns]
find_tweet<simdjson_ondemand>                1169990 ns      1169999 ns          598          31.802k           548.293M               0        30.487k    4.25194M              6.73292           868.219       3.69161G          10.0995M                    15.9925                     2.37527            868.219    32.7307k   631.515k       514.752M/s   0.147157   30.4952k   4.28681M         6.78813    854.702/s 3.66394G/s     10.0995M               15.9925                2.35595          1        854.702/s [BEST: throughput=  0.55 GB/s doc_throughput=   868 docs/s instructions=    10099497 cycles=     4251937 branch_miss=   31802 cache_miss=       0 cache_ref=     30487 items=         1 avg_time=   1161768 ns]
find_tweet<yyjson>                            627948 ns       627934 ns         1121           9.553k           1.59394G             246        60.607k    1.29176M              2.04549          2.52399k       3.26039G          2.81729M                    4.46116                     2.18097           2.52399k    7.26638k   631.515k       959.113M/s   1.24798k   41.9957k   1.46177M          2.3147   1.59252k/s  2.3279G/s     2.81772M               4.46184                1.92761          1       1.59252k/s [BEST: throughput=  1.59 GB/s doc_throughput=  2523 docs/s instructions=     2817291 cycles=     1291760 branch_miss=    9553 cache_miss=     246 cache_ref=     60607 items=         1 avg_time=    618887 ns]
